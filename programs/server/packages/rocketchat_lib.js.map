{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:lib/lib/getURL.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/fileUploadRestrictions.js","meteor://ðŸ’»app/packages/rocketchat:lib/lib/placeholders.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/debug.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/bugsnag.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/metrics.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/PushNotification.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/defaultBlockedDomainsList.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/notifyUsersOnMessage.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/sendEmailOnMessage.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/sendNotificationsOnMessage.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/lib/validateEmailDomain.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/isDocker.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/addUserToDefaultChannels.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/addUserToRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/archiveRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/checkEmailAvailability.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/createRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/deleteMessage.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/deleteUser.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/getFullUserData.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/getRoomByNameOrIdWithOptionToJoin.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/removeUserFromRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/saveUser.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/saveCustomFields.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/setUserAvatar.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/setEmail.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/unarchiveRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/functions/updateMessage.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/models/_Base.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/models/_BaseCache.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/models/_BaseDb.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/startup/statsTracker.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/startup/cache/CacheLoad.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/addOAuthService.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/refreshOAuthService.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/addUserToRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/addUsersToRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/archiveRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/blockUser.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/checkRegistrationSecretURL.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/cleanChannelHistory.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/createChannel.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/createPrivateGroup.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/deleteUserOwnAccount.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/filterBadWords.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/filterATAllTag.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/getChannelHistory.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/getFullUserData.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/getRoomRoles.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/getServerInfo.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/getUserRoles.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/insertOrUpdateUser.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/joinDefaultChannels.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/joinRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/leaveRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/removeOAuthService.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/restartServer.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/saveSetting.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/setAdminStatus.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/setRealName.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/setUsername.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/setEmail.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/unarchiveRoom.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/unblockUser.js","meteor://ðŸ’»app/packages/rocketchat:lib/server/methods/updateMessage.js","meteor://ðŸ’»app/packages/rocketchat:lib/startup/defaultRoomTypes.js"],"names":["RocketChat","getURL","path","cdn","full","cdnPrefix","_","rtrim","trim","settings","get","pathPrefix","__meteor_runtime_config__","ROOT_URL_PATH_PREFIX","basePath","finalPath","ltrim","Meteor","isCordova","absoluteUrl","fileUploadMediaWhiteList","mediaTypeWhiteList","map","split","item","fileUploadIsValidContentType","type","list","wildCardGlob","wildcards","contains","filter","indexOf","replace","placeholders","str","data","name","strLeft","strRightBack","email","password","unsubscribe","logger","Logger","methods","method","publish","wrapMethods","originalHandler","methodsMap","args","Array","prototype","slice","call","arguments","userId","apply","originalMeteorMethods","methodMap","each","handler","originalMeteorPublish","func","bugsnag","module","import","v","key","value","register","notify","message","stack","options","Info","app","version","info","error","Error","process","on","bindEnvironment","originalMeteorDebug","_debug","client","require","promclient","metrics","messagesSent","Counter","PushNotification","getNotificationId","roomId","serverId","hash","i","length","charCodeAt","send","roomName","username","usersTo","payload","title","icon","url","defaultUrl","config","from","badge","sound","text","query","notId","gcm","style","summaryText","image","apn","Push","emailDomainDefaultBlackList","moment","callbacks","add","room","editedAt","Math","abs","diff","models","Rooms","incMsgCountById","rid","ts","messageContainsHighlight","highlights","has","some","highlight","regexp","RegExp","s","escapeRegExp","test","msg","t","Subscriptions","incUnreadOfDirectForRoomIdExcludingUserId","u","_id","mentionIds","toAll","highlightsIds","Users","findUsersByUsernamesWithHighlights","usernames","fields","fetch","mentions","forEach","mention","push","user","preferences","incUnreadForRoomIdExcludingUserId","incUnreadForRoomIdAndUserIds","compact","unique","concat","incMsgCountAndSetLastMessageTimestampById","setAlertForRoomIdExcludingUserId","priority","LOW","emailSubject","usersToSendEmail","directMessage","TAPi18n","__","getMessageLink","sub","roomPath","roomTypes","getRouteLink","join","divisorMessage","messageHTML","escapeHTML","run","tokens","token","header","footer","findWithSendEmailByRoomId","emailNotifications","userIdsToSendEmail","Object","keys","defaultLink","linkByUser","hasCustomLink","findByRoomIdAndUserIds","usersOfMention","getUsersToSendOfflineEmail","siteName","emailNotificationMode","emails","verified","to","address","subject","html","defer","Email","findOneById","l","desktopMentionIds","j","len","len1","usersWithHighlights","mobileMentionIds","ref","ref1","toHere","userIdsToNotify","userIdsToPushNotify","userOfMention","userOfMentionId","usersOfDesktopMentions","usersOfMentionId","usersOfMentionItem","usersOfMobileMentions","canBeNotified","id","types","mobile","desktop","alwaysNotifyDesktopUsers","dontNotifyDesktopUsers","alwaysNotifyMobileUsers","dontNotifyMobileUsers","desktopNotificationDurations","notificationPreferencesByRoom","findNotificationPreferencesByRoom","subscription","desktopNotifications","mobilePushNotifications","desktopNotificationDuration","push_message","push_username","push_room","findOne","statusConnection","Sandstorm","Notifications","notifyUser","duration","sender","enabled","host","union","difference","find","$in","active","callJoin","runAsUser","reject","pluck","$ne","status","ref2","ref3","ref4","without","allUserIdsToNotify","dns","Npm","emailDomainBlackList","emailDomainWhiteList","useDefaultBlackList","useDNSDomainCheck","domain","validateEmailDomain","emailValidation","emailDomain","substr","lastIndexOf","wrapAsync","resolveMx","e","fs","hasDockerEnv","statSync","err","hasDockerCGroup","readFileSync","check","isDocker","undefined","addUserToDefaultChannels","silenced","defaultRooms","findByDefaultAndTypes","muted","ro","authz","hasPermission","addUsernameById","findOneByRoomIdAndUserId","createWithRoomAndUser","Date","open","alert","unread","Messages","createUserJoinWithRoomIdAndUser","addUserToRoom","inviter","now","createUserAddedWithRoomIdAndUser","archiveRoom","archiveById","archiveByRoomId","checkEmailAvailability","users","$regex","createRoom","owner","members","readOnly","extraData","findOneByUsername","nameValidation","findOneByName","archived","room_name","sysMes","assign","createWithTypeNameUserAndUsernames","member","muteUsernameByRoomId","extra","ls","addUserRoles","deleteMessage","keepHistory","showDeletedStatus","deletedMsg","cloneAndSaveAsHistoryById","setHiddenById","file","Uploads","update","$set","_hidden","removeById","FileUpload","delete","setAsDeletedByIdAndUser","notifyRoom","deleteUser","removeByUserId","findByUserId","removeByRoomId","removeByTypeContainingUsername","removeUsernameFromAll","avatarOrigin","RocketChatFileAvatarInstance","deleteFile","encodeURIComponent","Integrations","disableByUserId","getFullUserData","limit","utcOffset","extend","phone","createdAt","lastLogin","services","requirePasswordChange","requirePasswordChangeReason","roles","customFields","sort","findByUsername","filterReg","findByUsernameNameOrEmailAddress","getRoomByNameOrIdWithOptionToJoin","_getRoomByNameOrIdWithOptionToJoin","currentUserId","nameOrId","tryDirectByUserIdOnly","joinChannel","errorOnEmpty","startsWith","substring","findOneByIdOrName","roomUser","$or","isObject","removeUserFromRoom","removeUsernameById","removedUser","createUserLeaveWithRoomIdAndUser","createCommandWithRoomIdAndUser","removeByRoomIdAndUserId","saveUser","userData","existingRoles","getRoles","action","field","escape","input","checkUsernameAvailability","createUser","joinDefaultChannels","Accounts","updateUser","sendWelcomeEmail","lng","language","gravatarUrl","Gravatar","imageUrl","size","secure","setUserAvatar","setUsername","setEmail","setPassword","saveCustomFields","formData","customFieldsMeta","JSON","parse","fieldName","required","maxLength","minLength","setCustomFields","modifyRecordField","array","$addToSet","dataURI","contentType","service","encoding","setAvatarOrigin","result","HTTP","npmRequestOptions","response","statusCode","console","log","headers","content","fileData","RocketChatFile","dataURIParse","rs","bufferToStream","Buffer","ws","createWriteStream","setTimeout","notifyLogged","pipe","_setEmail","RateLimiter","limitFunction","unarchiveRoom","unarchiveById","unarchiveByRoomId","updateMessage","editedBy","urls","match","tempid","ModelsBaseDb","ModelsBaseCache","_CacheControl","EnvironmentVariable","ModelsBase","nameOrModel","useCache","_db","model","collectionName","_useCache","cache","bind","emit","getDynamicView","processQueryOptionsOnResult","db","constructor","arrayToCursor","count","fn","setUpdatedAt","origin","findOneByIds","ids","String","insert","upsert","remove","insertOrUpsert","allow","deny","ensureIndex","dropIndex","tryEnsureIndex","tryDropIndex","trashFind","trashFindDeletedAfter","_Base","loki","EventEmitter","objectPath","lokiEq","LokiOps","$eq","lokiNe","a","b","isArray","lokiIn","subA","$nin","$all","every","includes","subB","$exists","$elemMatch","findWhere","ignore","traceMethodCalls","target","_stats","property","calls","time","avg","origMethod","loaded","startTime","statsTracker","round","setInterval","hasOwnProperty","tags","timing","increment","_getStatsAvg","stats","sortBy","record","Adapter","loadDatabase","saveDatabase","deleteDatabase","adapter","indexes","ignoreUpdatedFields","joins","collection","addCollection","hasOne","link","multi","hasMany","processRemoteJoinInserted","remote","processRemoteJoinRemoved","localRecord","processLocalJoinInserted","local","localRecords","_findByIndex","transform","records","splice","addToAllIndexes","indexName","addToIndex","index","removeFromAllIndexes","removeFromIndex","findByIndex","load","startSync","updateDiffById","r","direction","valueA","valueB","skip","fieldsToRemove","fieldsToGet","warn","pickFields","obj","picked","set","omit","processQuery","parentField","Match","and","$and","subValue","stringify","observe","debug","observeChanges","_publishCursor","cursor","addDynamicView","updatedFields","updateRecord","topLevelFields","$unset","del","$min","curValue","$max","$inc","$mul","$rename","$pullAll","$pop","shift","pop","$each","valueItem","removeWhere","export","exports","default","baseName","trash","Mongo","Collection","_ensureIndex","_deletedAt","expireAfterSeconds","isOplogAvailable","MongoInternals","defaultRemoteCollectionDriver","mongo","_oplogHandle","onOplogEntry","isOplogEnabled","baseModel","_name","wrapModel","once","event","processOplogRecord","_defineTooFarBehind","Number","MAX_SAFE_INTEGER","_updatedAt","originals","self","defineSyncStrategy","modifier","cacheAllowedModifiers","notAllowedModifiers","placeholderFields","updateHasPositionalOperator","op","o","oplog","listenerCount","strategy","findOptions","insertedId","_returnObject","__collection__","unshift","_dropIndex","deletedAt","$gt","StatsD","dogstatsd","track","hrtime","decrement","histogram","gauge","arr","Settings","applyFind","$size","addOAuthService","toLowerCase","capitalize","group","section","i18nLabel","persistent","values","refreshOAuthService","ServiceConfiguration","configurations","addUsersToRoom","userInRoom","canAddUser","newUser","blockUser","blocked","subscription2","setBlockedByRoomId","checkRegistrationSecretURL","cleanChannelHistory","latest","oldest","inclusive","Boolean","$gte","$lte","$lt","createChannel","Optional","createPrivateGroup","deleteUserOwnAccount","bcrypt","_checkPassword","digest","algorithm","Filter","badWordsList","clean","Random","getChannelHistory","unreads","fromUserId","isUndefined","isDate","findVisibleByRoomIdBeforeTimestampInclusive","findVisibleByRoomIdBeforeTimestamp","findVisibleByRoomIdBetweenTimestampsInclusive","findVisibleByRoomIdBetweenTimestamps","messages","starred","unreadNotLoaded","firstUnread","firstMsg","unreadMessages","getRoomRoles","Roles","scope","description","findByRoomIdAndRoles","getServerInfo","getUserRoles","roleIds","findUsersInRoles","intersection","insertOrUpdateUser","unblock","joinRoom","code","joinCodeRequired","joinCode","leaveRoom","hasRole","numOwners","getUsersInRole","removeOAuthService","restart_server","exit","params","saveSetting","editor","setting","updateById","setAdminStatus","admin","setRealName","setName","param","joinDefaultChannelsSilenced","limitMethod","unblockUser","unsetBlockedByRoomId","ObjectIncluding","originalMessage","editAllowed","editOwn","blockEditInMinutes","currentTsDiff","msgTs","template","route","openRoom","findRoom","identifier","ChatRoom","roomData","condition","hasAtLeastOnePermission","showJoinLink","ChatSubscription","getUserStatus","Session","hasAllPermission"],"mappings":"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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1LA,IAAImC,aAAJ;AAAS1c,OAAOC,MAAP,CAAc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","file":"/packages/rocketchat_lib.js","sourcesContent":["RocketChat.getURL = (path, { cdn = true, full = false } = {}) => {\n\tconst cdnPrefix = _.rtrim(_.trim(RocketChat.settings.get('CDN_PREFIX') || ''), '/');\n\tconst pathPrefix = _.rtrim(_.trim(__meteor_runtime_config__.ROOT_URL_PATH_PREFIX || ''), '/');\n\n\tlet basePath;\n\n\tconst finalPath = _.ltrim(_.trim(path), '/');\n\n\tif (cdn && cdnPrefix !== '') {\n\t\tbasePath = cdnPrefix + pathPrefix;\n\t} else if (full || Meteor.isCordova) {\n\t\treturn Meteor.absoluteUrl(finalPath);\n\t} else {\n\t\tbasePath = pathPrefix;\n\t}\n\n\treturn basePath + '/' + finalPath;\n};\n","RocketChat.fileUploadMediaWhiteList = function() {\n\tvar mediaTypeWhiteList = RocketChat.settings.get('FileUpload_MediaTypeWhiteList');\n\n\tif (!mediaTypeWhiteList || mediaTypeWhiteList === '*') {\n\t\treturn;\n\t}\n\treturn _.map(mediaTypeWhiteList.split(','), function(item) {\n\t\treturn item.trim();\n\t});\n};\n\nRocketChat.fileUploadIsValidContentType = function(type) {\n\tvar list, wildCardGlob, wildcards;\n\tlist = RocketChat.fileUploadMediaWhiteList();\n\tif (!list || _.contains(list, type)) {\n\t\treturn true;\n\t} else {\n\t\twildCardGlob = '/*';\n\t\twildcards = _.filter(list, function(item) {\n\t\t\treturn item.indexOf(wildCardGlob) > 0;\n\t\t});\n\t\tif (_.contains(wildcards, type.replace(/(\\/.*)$/, wildCardGlob))) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n};\n","RocketChat.placeholders = {};\n\nRocketChat.placeholders.replace = function(str, data) {\n\tif (!str) {\n\t\treturn '';\n\t}\n\n\tstr = str.replace(/\\[Site_Name\\]/g, RocketChat.settings.get('Site_Name') || '');\n\tstr = str.replace(/\\[Site_URL\\]/g, RocketChat.settings.get('Site_Url') || '');\n\n\tif (data) {\n\t\tstr = str.replace(/\\[name\\]/g, data.name || '');\n\t\tstr = str.replace(/\\[fname\\]/g, _.strLeft(data.name, ' ') || '');\n\t\tstr = str.replace(/\\[lname\\]/g, _.strRightBack(data.name, ' ') || '');\n\t\tstr = str.replace(/\\[email\\]/g, data.email || '');\n\t\tstr = str.replace(/\\[password\\]/g, data.password || '');\n\n\t\tif (data.unsubscribe) {\n\t\t\tstr = str.replace(/\\[unsubscribe\\]/g, data.unsubscribe);\n\t\t}\n\t}\n\n\tstr = str.replace(/([^>\\r\\n]?)(\\r\\n|\\n\\r|\\r|\\n)/g, '$1' + '<br>' + '$2');\n\n\n\treturn str;\n};\n","var logger = new Logger('Meteor', {\n\tmethods: {\n\t\tmethod: {\n\t\t\ttype: 'debug'\n\t\t},\n\t\tpublish: {\n\t\t\ttype: 'debug'\n\t\t}\n\t}\n});\n\nvar wrapMethods = function(name, originalHandler, methodsMap) {\n\tmethodsMap[name] = function() {\n\t\tvar args = name === 'ufsWrite' ? Array.prototype.slice.call(arguments, 1) : arguments;\n\t\tlogger.method(name, '-> userId:', Meteor.userId(), ', arguments: ', args);\n\n\t\treturn originalHandler.apply(this, arguments);\n\t};\n};\n\nvar originalMeteorMethods = Meteor.methods;\n\nMeteor.methods = function(methodMap) {\n\t_.each(methodMap, function(handler, name) {\n\t\twrapMethods(name, handler, methodMap);\n\t});\n\toriginalMeteorMethods(methodMap);\n};\n\nvar originalMeteorPublish = Meteor.publish;\n\nMeteor.publish = function(name, func) {\n\treturn originalMeteorPublish(name, function() {\n\t\tlogger.publish(name, '-> userId:', this.userId, ', arguments: ', arguments);\n\n\t\treturn func.apply(this, arguments);\n\t});\n};\n","import bugsnag from 'bugsnag';\n\nRocketChat.bugsnag = bugsnag;\n\nRocketChat.settings.get('Bugsnag_api_key', (key, value) => {\n\tif (value) {\n\t\tbugsnag.register(value);\n\t}\n});\n\nconst notify = function(message, stack) {\n\tif (typeof stack === 'string') {\n\t\tmessage += ' ' + stack;\n\t}\n\tlet options = {};\n\tif (RocketChat.Info) {\n\t\toptions = { app: { version: RocketChat.Info.version, info: RocketChat.Info } };\n\t}\n\tconst error = new Error(message);\n\terror.stack = stack;\n\tRocketChat.bugsnag.notify(error, options);\n};\n\nprocess.on('uncaughtException', Meteor.bindEnvironment((error) => {\n\tnotify(error.message, error.stack);\n\tthrow error;\n}));\n\nconst originalMeteorDebug = Meteor._debug;\nMeteor._debug = function() {\n\tnotify(...arguments);\n\treturn originalMeteorDebug(...arguments);\n};\n","var client = require('prom-client');\n\nRocketChat.promclient = client;\n\nRocketChat.metrics = {};\n\n// one sample metrics only - a counter\n\nRocketChat.metrics.messagesSent = new client.Counter('messages_sent', 'cumulated number of messages sent');\n","/* globals Push */\nclass PushNotification {\n\tgetNotificationId(roomId) {\n\t\tconst serverId = RocketChat.settings.get('uniqueID');\n\t\treturn this.hash(`${serverId}|${roomId}`); // hash\n\t}\n\n\thash(str) {\n\t\tlet hash = 0,\n\t\t\ti = str.length;\n\n\t\twhile (i) {\n\t\t\thash = ((hash << 5) - hash) + str.charCodeAt(--i);\n\t\t\thash = hash & hash; // Convert to 32bit integer\n\t\t}\n\t\treturn hash;\n\t}\n\n\tsend({ roomName, roomId, username, message, usersTo, payload }) {\n\t\tlet title;\n\t\tif (roomName && roomName !== '') {\n\t\t\ttitle = `${roomName}`;\n\t\t\tmessage = `${username}: ${message}`;\n\t\t} else {\n\t\t\ttitle = `${username}`;\n\t\t}\n\t\tconst icon = RocketChat.settings.get('Assets_favicon_192').url || RocketChat.settings.get('Assets_favicon_192').defaultUrl;\n\t\tconst config = {\n\t\t\tfrom: 'push',\n\t\t\tbadge: 1,\n\t\t\tsound: 'default',\n\t\t\ttitle: title,\n\t\t\ttext: message,\n\t\t\tpayload,\n\t\t\tquery: usersTo,\n\t\t\tnotId: this.getNotificationId(roomId),\n\t\t\tgcm: {\n\t\t\t\tstyle: 'inbox',\n\t\t\t\tsummaryText: '%n% new messages',\n\t\t\t\timage: RocketChat.getURL(icon, { full: true })\n\t\t\t},\n\t\t\tapn: {\n\t\t\t\ttext: title + ((title !== '' && message !== '') ? '\\n' : '') + message\n\t\t\t}\n\t\t};\n\n\t\treturn Push.send(config);\n\t}\n}\n\nRocketChat.PushNotification = new PushNotification();\n","RocketChat.emailDomainDefaultBlackList = [\n\t'0-mail.com',\n\t'0815.ru',\n\t'0815.su',\n\t'0clickemail.com',\n\t'0wnd.net',\n\t'0wnd.org',\n\t'10mail.org',\n\t'10minut.com.pl',\n\t'10minutemail.co.za',\n\t'10minutemail.com',\n\t'10minutemail.de',\n\t'123-m.com',\n\t'1chuan.com',\n\t'1fsdfdsfsdf.tk',\n\t'1pad.de',\n\t'1zhuan.com',\n\t'20email.eu',\n\t'20mail.eu',\n\t'20mail.it',\n\t'20minutemail.com',\n\t'21cn.com',\n\t'2fdgdfgdfgdf.tk',\n\t'2prong.com',\n\t'30minutemail.com',\n\t'33mail.com',\n\t'3d-painting.com',\n\t'3trtretgfrfe.tk',\n\t'4gfdsgfdgfd.tk',\n\t'4warding.com',\n\t'4warding.net',\n\t'4warding.org',\n\t'5ghgfhfghfgh.tk',\n\t'60minutemail.com',\n\t'675hosting.com',\n\t'675hosting.net',\n\t'675hosting.org',\n\t'6hjgjhgkilkj.tk',\n\t'6ip.us',\n\t'6paq.com',\n\t'6url.com',\n\t'75hosting.com',\n\t'75hosting.net',\n\t'75hosting.org',\n\t'7days-printing.com',\n\t'7tags.com',\n\t'99experts.com',\n\t'9ox.net',\n\t'a-bc.net',\n\t'a45.in',\n\t'abcmail.email',\n\t'abyssmail.com',\n\t'acentri.com',\n\t'advantimo.com',\n\t'afrobacon.com',\n\t'ag.us.to',\n\t'agedmail.com',\n\t'ahk.jp',\n\t'ajaxapp.net',\n\t'alivance.com',\n\t'ama-trade.de',\n\t'amail.com',\n\t'amilegit.com',\n\t'amiri.net',\n\t'amiriindustries.com',\n\t'anappthat.com',\n\t'ano-mail.net',\n\t'anonbox.net',\n\t'anonmails.de',\n\t'anonymail.dk',\n\t'anonymbox.com',\n\t'antichef.com',\n\t'antichef.net',\n\t'antireg.ru',\n\t'antispam.de',\n\t'antispammail.de',\n\t'appixie.com',\n\t'armyspy.com',\n\t'artman-conception.com',\n\t'aver.com',\n\t'azmeil.tk',\n\t'baxomale.ht.cx',\n\t'beddly.com',\n\t'beefmilk.com',\n\t'bigprofessor.so',\n\t'bigstring.com',\n\t'binkmail.com',\n\t'bio-muesli.net',\n\t'blogmyway.org',\n\t'bobmail.info',\n\t'bofthew.com',\n\t'bootybay.de',\n\t'boun.cr',\n\t'bouncr.com',\n\t'boxformail.in',\n\t'breakthru.com',\n\t'brefmail.com',\n\t'brennendesreich.de',\n\t'broadbandninja.com',\n\t'bsnow.net',\n\t'bspamfree.org',\n\t'bu.mintemail.com',\n\t'buffemail.com',\n\t'bugmenot.com',\n\t'bumpymail.com',\n\t'bund.us',\n\t'bundes-li.ga',\n\t'burnthespam.info',\n\t'burstmail.info',\n\t'buymoreplays.com',\n\t'buyusedlibrarybooks.org',\n\t'byom.de',\n\t'c2.hu',\n\t'cachedot.net',\n\t'card.zp.ua',\n\t'casualdx.com',\n\t'cbair.com',\n\t'cek.pm',\n\t'cellurl.com',\n\t'centermail.com',\n\t'centermail.net',\n\t'chammy.info',\n\t'cheatmail.de',\n\t'childsavetrust.org',\n\t'chogmail.com',\n\t'choicemail1.com',\n\t'chong-mail.com',\n\t'chong-mail.net',\n\t'chong-mail.org',\n\t'clixser.com',\n\t'cmail.com',\n\t'cmail.net',\n\t'cmail.org',\n\t'coldemail.info',\n\t'consumerriot.com',\n\t'cool.fr.nf',\n\t'correo.blogos.net',\n\t'cosmorph.com',\n\t'courriel.fr.nf',\n\t'courrieltemporaire.com',\n\t'crapmail.org',\n\t'crazymailing.com',\n\t'cubiclink.com',\n\t'curryworld.de',\n\t'cust.in',\n\t'cuvox.de',\n\t'd3p.dk',\n\t'dacoolest.com',\n\t'daintly.com',\n\t'dandikmail.com',\n\t'dayrep.com',\n\t'dbunker.com',\n\t'dcemail.com',\n\t'deadaddress.com',\n\t'deadspam.com',\n\t'deagot.com',\n\t'dealja.com',\n\t'delikkt.de',\n\t'despam.it',\n\t'despammed.com',\n\t'devnullmail.com',\n\t'dfgh.net',\n\t'digitalsanctuary.com',\n\t'dingbone.com',\n\t'discard.email',\n\t'discardmail.com',\n\t'discardmail.de',\n\t'disposableaddress.com',\n\t'disposableemailaddresses.com',\n\t'disposableemailaddresses.emailmiser.com',\n\t'disposableinbox.com',\n\t'dispose.it',\n\t'disposeamail.com',\n\t'disposemail.com',\n\t'dispostable.com',\n\t'dlemail.ru',\n\t'dm.w3internet.co.uk',\n\t'dm.w3internet.co.ukexample.com',\n\t'dodgeit.com',\n\t'dodgit.com',\n\t'dodgit.org',\n\t'doiea.com',\n\t'domozmail.com',\n\t'donemail.ru',\n\t'dontreg.com',\n\t'dontsendmespam.de',\n\t'dotmsg.com',\n\t'drdrb.com',\n\t'drdrb.net',\n\t'droplar.com',\n\t'dropmail.me',\n\t'dt.com',\n\t'duam.net',\n\t'dudmail.com',\n\t'dump-email.info',\n\t'dumpandjunk.com',\n\t'dumpmail.de',\n\t'dumpyemail.com',\n\t'duskmail.com',\n\t'e-mail.com',\n\t'e-mail.org',\n\t'e4ward.com',\n\t'easytrashmail.com',\n\t'einmalmail.de',\n\t'einrot.com',\n\t'einrot.de',\n\t'eintagsmail.de',\n\t'email60.com',\n\t'emaildienst.de',\n\t'emailgo.de',\n\t'emailias.com',\n\t'emailigo.de',\n\t'emailinfive.com',\n\t'emaillime.com',\n\t'emailmiser.com',\n\t'emailproxsy.com',\n\t'emailsensei.com',\n\t'emailtemporanea.com',\n\t'emailtemporanea.net',\n\t'emailtemporar.ro',\n\t'emailtemporario.com.br',\n\t'emailthe.net',\n\t'emailtmp.com',\n\t'emailto.de',\n\t'emailwarden.com',\n\t'emailx.at.hm',\n\t'emailxfer.com',\n\t'emeil.in',\n\t'emeil.ir',\n\t'emil.com',\n\t'emz.net',\n\t'enterto.com',\n\t'ephemail.net',\n\t'ero-tube.org',\n\t'etranquil.com',\n\t'etranquil.net',\n\t'etranquil.org',\n\t'evopo.com',\n\t'explodemail.com',\n\t'express.net.ua',\n\t'eyepaste.com',\n\t'fakeinbox.com',\n\t'fakeinformation.com',\n\t'fakemail.fr',\n\t'fakemailz.com',\n\t'fammix.com',\n\t'fansworldwide.de',\n\t'fantasymail.de',\n\t'fastacura.com',\n\t'fastchevy.com',\n\t'fastchrysler.com',\n\t'fastkawasaki.com',\n\t'fastmazda.com',\n\t'fastmitsubishi.com',\n\t'fastnissan.com',\n\t'fastsubaru.com',\n\t'fastsuzuki.com',\n\t'fasttoyota.com',\n\t'fastyamaha.com',\n\t'fatflap.com',\n\t'fdfdsfds.com',\n\t'fightallspam.com',\n\t'figjs.com',\n\t'fiifke.de',\n\t'filzmail.com',\n\t'fivemail.de',\n\t'fixmail.tk',\n\t'fizmail.com',\n\t'fleckens.hu',\n\t'flemail.ru',\n\t'flyspam.com',\n\t'footard.com',\n\t'forgetmail.com',\n\t'fr33mail.info',\n\t'frapmail.com',\n\t'freundin.ru',\n\t'friendlymail.co.uk',\n\t'front14.org',\n\t'fuckingduh.com',\n\t'fudgerub.com',\n\t'fux0ringduh.com',\n\t'fyii.de',\n\t'garliclife.com',\n\t'gehensiemirnichtaufdensack.de',\n\t'gelitik.in',\n\t'get1mail.com',\n\t'get2mail.fr',\n\t'getairmail.com',\n\t'getmails.eu',\n\t'getonemail.com',\n\t'getonemail.net',\n\t'ghosttexter.de',\n\t'giantmail.de',\n\t'girlsundertheinfluence.com',\n\t'gishpuppy.com',\n\t'gmial.com',\n\t'goemailgo.com',\n\t'gorillaswithdirtyarmpits.com',\n\t'gotmail.com',\n\t'gotmail.net',\n\t'gotmail.org',\n\t'gotti.otherinbox.com',\n\t'gowikibooks.com',\n\t'gowikicampus.com',\n\t'gowikicars.com',\n\t'gowikifilms.com',\n\t'gowikigames.com',\n\t'gowikimusic.com',\n\t'gowikimusic.great-host.in',\n\t'gowikinetwork.com',\n\t'gowikitravel.com',\n\t'gowikitv.com',\n\t'grandmamail.com',\n\t'grandmasmail.com',\n\t'great-host.in',\n\t'greensloth.com',\n\t'grr.la',\n\t'gsrv.co.uk',\n\t'guerillamail.biz',\n\t'guerillamail.com',\n\t'guerillamail.net',\n\t'guerillamail.org',\n\t'guerrillamail.biz',\n\t'guerrillamail.com',\n\t'guerrillamail.de',\n\t'guerrillamail.info',\n\t'guerrillamail.net',\n\t'guerrillamail.org',\n\t'guerrillamailblock.com',\n\t'gustr.com',\n\t'h.mintemail.com',\n\t'h8s.org',\n\t'hacccc.com',\n\t'haltospam.com',\n\t'harakirimail.com',\n\t'hartbot.de',\n\t'hat-geld.de',\n\t'hatespam.org',\n\t'hellodream.mobi',\n\t'herp.in',\n\t'hidemail.de',\n\t'hidzz.com',\n\t'hmamail.com',\n\t'hochsitze.com',\n\t'hopemail.biz',\n\t'hotpop.com',\n\t'hulapla.de',\n\t'iaoss.com',\n\t'ieatspam.eu',\n\t'ieatspam.info',\n\t'ieh-mail.de',\n\t'ihateyoualot.info',\n\t'iheartspam.org',\n\t'ikbenspamvrij.nl',\n\t'imails.info',\n\t'imgof.com',\n\t'imstations.com',\n\t'inbax.tk',\n\t'inbox.si',\n\t'inboxalias.com',\n\t'inboxclean.com',\n\t'inboxclean.org',\n\t'inboxproxy.com',\n\t'incognitomail.com',\n\t'incognitomail.net',\n\t'incognitomail.org',\n\t'infocom.zp.ua',\n\t'inoutmail.de',\n\t'inoutmail.eu',\n\t'inoutmail.info',\n\t'inoutmail.net',\n\t'insorg-mail.info',\n\t'instant-mail.de',\n\t'ip6.li',\n\t'ipoo.org',\n\t'irish2me.com',\n\t'iwi.net',\n\t'jamit.com.au',\n\t'jetable.com',\n\t'jetable.fr.nf',\n\t'jetable.net',\n\t'jetable.org',\n\t'jnxjn.com',\n\t'jourrapide.com',\n\t'jsrsolutions.com',\n\t'junk1e.com',\n\t'kasmail.com',\n\t'kaspop.com',\n\t'keepmymail.com',\n\t'killmail.com',\n\t'killmail.net',\n\t'kimsdisk.com',\n\t'kingsq.ga',\n\t'kir.ch.tc',\n\t'klassmaster.com',\n\t'klassmaster.net',\n\t'klzlk.com',\n\t'kook.ml',\n\t'koszmail.pl',\n\t'kulturbetrieb.info',\n\t'kurzepost.de',\n\t'l33r.eu',\n\t'lackmail.net',\n\t'lags.us',\n\t'lawlita.com',\n\t'lazyinbox.com',\n\t'letthemeatspam.com',\n\t'lhsdv.com',\n\t'lifebyfood.com',\n\t'link2mail.net',\n\t'litedrop.com',\n\t'loadby.us',\n\t'login-email.ml',\n\t'lol.ovpn.to',\n\t'lolfreak.net',\n\t'lookugly.com',\n\t'lopl.co.cc',\n\t'lortemail.dk',\n\t'lovemeleaveme.com',\n\t'lr78.com',\n\t'lroid.com',\n\t'lukop.dk',\n\t'm21.cc',\n\t'm4ilweb.info',\n\t'maboard.com',\n\t'mail-filter.com',\n\t'mail-temporaire.fr',\n\t'mail.by',\n\t'mail.mezimages.net',\n\t'mail.zp.ua',\n\t'mail114.net',\n\t'mail1a.de',\n\t'mail21.cc',\n\t'mail2rss.org',\n\t'mail333.com',\n\t'mail4trash.com',\n\t'mailbidon.com',\n\t'mailbiz.biz',\n\t'mailblocks.com',\n\t'mailbucket.org',\n\t'mailcat.biz',\n\t'mailcatch.com',\n\t'mailde.de',\n\t'mailde.info',\n\t'maildrop.cc',\n\t'maildx.com',\n\t'maileater.com',\n\t'mailed.ro',\n\t'maileimer.de',\n\t'mailexpire.com',\n\t'mailfa.tk',\n\t'mailforspam.com',\n\t'mailfreeonline.com',\n\t'mailfs.com',\n\t'mailguard.me',\n\t'mailimate.com',\n\t'mailin8r.com',\n\t'mailinater.com',\n\t'mailinator.com',\n\t'mailinator.net',\n\t'mailinator.org',\n\t'mailinator.us',\n\t'mailinator2.com',\n\t'mailincubator.com',\n\t'mailismagic.com',\n\t'mailmate.com',\n\t'mailme.ir',\n\t'mailme.lv',\n\t'mailme24.com',\n\t'mailmetrash.com',\n\t'mailmetrash.comilzilla.org',\n\t'mailmoat.com',\n\t'mailms.com',\n\t'mailnator.com',\n\t'mailnesia.com',\n\t'mailnull.com',\n\t'mailorg.org',\n\t'mailpick.biz',\n\t'mailproxsy.com',\n\t'mailquack.com',\n\t'mailrock.biz',\n\t'mailscrap.com',\n\t'mailshell.com',\n\t'mailsiphon.com',\n\t'mailslapping.com',\n\t'mailslite.com',\n\t'mailtemp.info',\n\t'mailtome.de',\n\t'mailtothis.com',\n\t'mailtrash.net',\n\t'mailtv.net',\n\t'mailtv.tv',\n\t'mailzilla.com',\n\t'mailzilla.org',\n\t'mailzilla.orgmbx.cc',\n\t'makemetheking.com',\n\t'manifestgenerator.com',\n\t'manybrain.com',\n\t'mbx.cc',\n\t'mega.zik.dj',\n\t'meinspamschutz.de',\n\t'meltmail.com',\n\t'messagebeamer.de',\n\t'mezimages.net',\n\t'mierdamail.com',\n\t'migumail.com',\n\t'ministry-of-silly-walks.de',\n\t'mintemail.com',\n\t'misterpinball.de',\n\t'mjukglass.nu',\n\t'mmailinater.com',\n\t'moakt.com',\n\t'mobi.web.id',\n\t'mobileninja.co.uk',\n\t'moburl.com',\n\t'mohmal.com',\n\t'moncourrier.fr.nf',\n\t'monemail.fr.nf',\n\t'monmail.fr.nf',\n\t'monumentmail.com',\n\t'msa.minsmail.com',\n\t'mt2009.com',\n\t'mt2014.com',\n\t'mx0.wwwnew.eu',\n\t'my10minutemail.com',\n\t'mycard.net.ua',\n\t'mycleaninbox.net',\n\t'myemailboxy.com',\n\t'mymail-in.net',\n\t'mymailoasis.com',\n\t'mynetstore.de',\n\t'mypacks.net',\n\t'mypartyclip.de',\n\t'myphantomemail.com',\n\t'mysamp.de',\n\t'myspaceinc.com',\n\t'myspaceinc.net',\n\t'myspaceinc.org',\n\t'myspacepimpedup.com',\n\t'myspamless.com',\n\t'mytemp.email',\n\t'mytempemail.com',\n\t'mytempmail.com',\n\t'mytrashmail.com',\n\t'nabuma.com',\n\t'neomailbox.com',\n\t'nepwk.com',\n\t'nervmich.net',\n\t'nervtmich.net',\n\t'netmails.com',\n\t'netmails.net',\n\t'netzidiot.de',\n\t'neverbox.com',\n\t'nice-4u.com',\n\t'nincsmail.com',\n\t'nincsmail.hu',\n\t'nnh.com',\n\t'no-spam.ws',\n\t'noblepioneer.com',\n\t'nobulk.com',\n\t'noclickemail.com',\n\t'nogmailspam.info',\n\t'nomail.pw',\n\t'nomail.xl.cx',\n\t'nomail2me.com',\n\t'nomorespamemails.com',\n\t'nonspam.eu',\n\t'nonspammer.de',\n\t'noref.in',\n\t'nospam.ze.tc',\n\t'nospam4.us',\n\t'nospamfor.us',\n\t'nospammail.net',\n\t'nospamthanks.info',\n\t'notmailinator.com',\n\t'notsharingmy.info',\n\t'nowhere.org',\n\t'nowmymail.com',\n\t'nurfuerspam.de',\n\t'nus.edu.sg',\n\t'nwldx.com',\n\t'objectmail.com',\n\t'obobbo.com',\n\t'odaymail.com',\n\t'odnorazovoe.ru',\n\t'one-time.email',\n\t'oneoffemail.com',\n\t'oneoffmail.com',\n\t'onewaymail.com',\n\t'onlatedotcom.info',\n\t'online.ms',\n\t'oopi.org',\n\t'opayq.com',\n\t'ordinaryamerican.net',\n\t'otherinbox.codupmyspace.com',\n\t'otherinbox.com',\n\t'ourklips.com',\n\t'outlawspam.com',\n\t'ovpn.to',\n\t'owlpic.com',\n\t'pancakemail.com',\n\t'paplease.com',\n\t'pcusers.otherinbox.com',\n\t'pepbot.com',\n\t'pfui.ru',\n\t'pimpedupmyspace.com',\n\t'pjjkp.com',\n\t'plexolan.de',\n\t'poczta.onet.pl',\n\t'politikerclub.de',\n\t'pooae.com',\n\t'poofy.org',\n\t'pookmail.com',\n\t'privacy.net',\n\t'privatdemail.net',\n\t'privy-mail.com',\n\t'privymail.de',\n\t'proxymail.eu',\n\t'prtnx.com',\n\t'prtz.eu',\n\t'punkass.com',\n\t'putthisinyourspamdatabase.com',\n\t'pwrby.com',\n\t'quickinbox.com',\n\t'quickmail.nl',\n\t'rcpt.at',\n\t'reallymymail.com',\n\t'realtyalerts.ca',\n\t'recode.me',\n\t'recursor.net',\n\t'recyclemail.dk',\n\t'regbypass.com',\n\t'regbypass.comsafe-mail.net',\n\t'rejectmail.com',\n\t'reliable-mail.com',\n\t'rhyta.com',\n\t'rklips.com',\n\t'rmqkr.net',\n\t'royal.net',\n\t'rppkn.com',\n\t'rtrtr.com',\n\t's0ny.net',\n\t'safe-mail.net',\n\t'safersignup.de',\n\t'safetymail.info',\n\t'safetypost.de',\n\t'sandelf.de',\n\t'saynotospams.com',\n\t'schafmail.de',\n\t'schrott-email.de',\n\t'secretemail.de',\n\t'secure-mail.biz',\n\t'selfdestructingmail.com',\n\t'selfdestructingmail.org',\n\t'sendspamhere.com',\n\t'sendspamhere.com',\n\t'senseless-entertainment.com',\n\t'services391.com',\n\t'sharedmailbox.org',\n\t'sharklasers.com',\n\t'shieldedmail.com',\n\t'shieldemail.com',\n\t'shiftmail.com',\n\t'shitmail.me',\n\t'shitmail.org',\n\t'shitware.nl',\n\t'shmeriously.com',\n\t'shortmail.net',\n\t'shotmail.ru',\n\t'showslow.de',\n\t'sibmail.com',\n\t'sinnlos-mail.de',\n\t'siteposter.net',\n\t'skeefmail.com',\n\t'slapsfromlastnight.com',\n\t'slaskpost.se',\n\t'slipry.net',\n\t'slopsbox.com',\n\t'slushmail.com',\n\t'smashmail.de',\n\t'smellfear.com',\n\t'smellrear.com',\n\t'snakemail.com',\n\t'sneakemail.com',\n\t'sneakmail.de',\n\t'snkmail.com',\n\t'sofimail.com',\n\t'sofort-mail.de',\n\t'softpls.asia',\n\t'sogetthis.com',\n\t'sohu.com',\n\t'solvemail.info',\n\t'soodonims.com',\n\t'spa.com',\n\t'spaereplease.com',\n\t'spam.la',\n\t'spam.su',\n\t'spam4.me',\n\t'spamail.de',\n\t'spamarrest.com',\n\t'spamavert.com',\n\t'spambob.com',\n\t'spambob.net',\n\t'spambob.org',\n\t'spambog.com',\n\t'spambog.de',\n\t'spambog.net',\n\t'spambog.ru',\n\t'spambox.info',\n\t'spambox.irishspringrealty.com',\n\t'spambox.us',\n\t'spamcannon.com',\n\t'spamcannon.net',\n\t'spamcero.com',\n\t'spamcon.org',\n\t'spamcorptastic.com',\n\t'spamcowboy.com',\n\t'spamcowboy.net',\n\t'spamcowboy.org',\n\t'spamday.com',\n\t'spamex.com',\n\t'spamfree.eu',\n\t'spamfree24.com',\n\t'spamfree24.de',\n\t'spamfree24.eu',\n\t'spamfree24.info',\n\t'spamfree24.net',\n\t'spamfree24.org',\n\t'spamgoes.in',\n\t'spamgourmet.com',\n\t'spamgourmet.net',\n\t'spamgourmet.org',\n\t'spamherelots.com',\n\t'spamhereplease.com',\n\t'spamhole.com',\n\t'spamify.com',\n\t'spaminator.de',\n\t'spamkill.info',\n\t'spaml.com',\n\t'spaml.de',\n\t'spammotel.com',\n\t'spamobox.com',\n\t'spamoff.de',\n\t'spamsalad.in',\n\t'spamslicer.com',\n\t'spamspot.com',\n\t'spamstack.net',\n\t'spamthis.co.uk',\n\t'spamthisplease.com',\n\t'spamtrail.com',\n\t'spamtroll.net',\n\t'speed.1s.fr',\n\t'spikio.com',\n\t'spoofmail.de',\n\t'squizzy.de',\n\t'ssoia.com',\n\t'startkeys.com',\n\t'stinkefinger.net',\n\t'stop-my-spam.com',\n\t'stuffmail.de',\n\t'super-auswahl.de',\n\t'supergreatmail.com',\n\t'supermailer.jp',\n\t'superrito.com',\n\t'superstachel.de',\n\t'suremail.info',\n\t'svk.jp',\n\t'sweetxxx.de',\n\t'tagyourself.com',\n\t'talkinator.com',\n\t'tapchicuoihoi.com',\n\t'teewars.org',\n\t'teleosaurs.xyz',\n\t'teleworm.com',\n\t'teleworm.us',\n\t'temp-mail.org',\n\t'temp-mail.ru',\n\t'temp.emeraldwebmail.com',\n\t'temp.headstrong.de',\n\t'tempalias.com',\n\t'tempe-mail.com',\n\t'tempemail.biz',\n\t'tempemail.co.za',\n\t'tempemail.com',\n\t'tempemail.net',\n\t'tempemail.net',\n\t'tempinbox.co.uk',\n\t'tempinbox.com',\n\t'tempmail.eu',\n\t'tempmail.it',\n\t'tempmail2.com',\n\t'tempmaildemo.com',\n\t'tempmailer.com',\n\t'tempmailer.de',\n\t'tempomail.fr',\n\t'temporarily.de',\n\t'temporarioemail.com.br',\n\t'temporaryemail.net',\n\t'temporaryemail.us',\n\t'temporaryforwarding.com',\n\t'temporaryinbox.com',\n\t'temporarymailaddress.com',\n\t'tempsky.com',\n\t'tempthe.net',\n\t'tempymail.com',\n\t'thanksnospam.info',\n\t'thankyou2010.com',\n\t'thc.st',\n\t'thecloudindex.com',\n\t'thelimestones.com',\n\t'thisisnotmyrealemail.com',\n\t'thismail.net',\n\t'thrma.com',\n\t'throwawayemailaddress.com',\n\t'tilien.com',\n\t'tittbit.in',\n\t'tizi.com',\n\t'tmail.ws',\n\t'tmailinator.com',\n\t'toiea.com',\n\t'toomail.biz',\n\t'topranklist.de',\n\t'tradermail.info',\n\t'trash-amil.com',\n\t'trash-mail.at',\n\t'trash-mail.com',\n\t'trash-mail.de',\n\t'trash2009.com',\n\t'trash2010.com',\n\t'trash2011.com',\n\t'trashdevil.com',\n\t'trashdevil.de',\n\t'trashemail.de',\n\t'trashmail.at',\n\t'trashmail.com',\n\t'trashmail.de',\n\t'trashmail.me',\n\t'trashmail.net',\n\t'trashmail.org',\n\t'trashmail.ws',\n\t'trashmailer.com',\n\t'trashymail.com',\n\t'trashymail.net',\n\t'trbvm.com',\n\t'trbvn.com',\n\t'trialmail.de',\n\t'trillianpro.com',\n\t'tryalert.com',\n\t'turual.com',\n\t'twinmail.de',\n\t'twoweirdtricks.com',\n\t'tyldd.com',\n\t'uggsrock.com',\n\t'umail.net',\n\t'upliftnow.com',\n\t'uplipht.com',\n\t'uroid.com',\n\t'us.af',\n\t'username.e4ward.com',\n\t'venompen.com',\n\t'veryrealemail.com',\n\t'vidchart.com',\n\t'viditag.com',\n\t'viewcastmedia.com',\n\t'viewcastmedia.net',\n\t'viewcastmedia.org',\n\t'viewcastmediae',\n\t'viralplays.com',\n\t'vkcode.ru',\n\t'vomoto.com',\n\t'vpn.st',\n\t'vsimcard.com',\n\t'vubby.com',\n\t'walala.org',\n\t'walkmail.net',\n\t'walkmail.ru',\n\t'wasteland.rfc822.org',\n\t'webemail.me',\n\t'webm4il.info',\n\t'webuser.in',\n\t'wee.my',\n\t'weg-werf-email.de',\n\t'wegwerf-email-addressen.de',\n\t'wegwerf-emails.de',\n\t'wegwerfadresse.de',\n\t'wegwerfemail.com',\n\t'wegwerfemail.de',\n\t'wegwerfmail.de',\n\t'wegwerfmail.info',\n\t'wegwerfmail.net',\n\t'wegwerfmail.org',\n\t'wetrainbayarea.com',\n\t'wetrainbayarea.org',\n\t'wh4f.org',\n\t'whatiaas.com',\n\t'whatpaas.com',\n\t'whatsaas.com',\n\t'whopy.com',\n\t'whtjddn.33mail.com',\n\t'whyspam.me',\n\t'wilemail.com',\n\t'willhackforfood.biz',\n\t'willselfdestruct.com',\n\t'winemaven.info',\n\t'wronghead.com',\n\t'wuzup.net',\n\t'wuzupmail.net',\n\t'www.e4ward.com',\n\t'www.gishpuppy.com',\n\t'www.mailinator.com',\n\t'wwwnew.eu',\n\t'x.ip6.li',\n\t'xagloo.com',\n\t'xemaps.com',\n\t'xents.com',\n\t'xmaily.com',\n\t'xoxy.net',\n\t'xyzfree.net',\n\t'yapped.net',\n\t'yeah.net',\n\t'yep.it',\n\t'yogamaven.com',\n\t'yomail.info',\n\t'yopmail.com',\n\t'yopmail.fr',\n\t'yopmail.net',\n\t'yourdomain.com',\n\t'ypmail.webarnak.fr.eu.org',\n\t'yuurok.com',\n\t'z1p.biz',\n\t'za.com',\n\t'zehnminuten.de',\n\t'zehnminutenmail.de',\n\t'zetmail.com',\n\t'zippymail.info',\n\t'zoaxe.com',\n\t'zoemail.com',\n\t'zoemail.net',\n\t'zoemail.org',\n\t'zomg.info',\n\t'zxcv.com',\n\t'zxcvbnm.com',\n\t'zzz.com'\n];\n\n","import moment from 'moment';\n\nRocketChat.callbacks.add('afterSaveMessage', function(message, room) {\n\t// skips this callback if the message was edited and increments it if the edit was way in the past (aka imported)\n\tif (message.editedAt && Math.abs(moment(message.editedAt).diff()) > 60000) {\n\t\t//TODO: Review as I am not sure how else to get around this as the incrementing of the msgs count shouldn't be in this callback\n\t\tRocketChat.models.Rooms.incMsgCountById(message.rid, 1);\n\t\treturn message;\n\t} else if (message.editedAt) {\n\t\t// skips this callback if the message was edited\n\t\treturn message;\n\t}\n\n\tif (message.ts && Math.abs(moment(message.ts).diff()) > 60000) {\n\t\tRocketChat.models.Rooms.incMsgCountById(message.rid, 1);\n\t\treturn message;\n\t}\n\n\t/**\n\t * Chechs if a messages contains a user highlight\n\t *\n\t * @param {string} message\n\t * @param {array|undefined} highlights\n\t *\n\t * @returns {boolean}\n     */\n\tfunction messageContainsHighlight(message, highlights) {\n\t\tif (! highlights || highlights.length === 0) { return false; }\n\n\t\tvar has = false;\n\t\thighlights.some(function(highlight) {\n\t\t\tvar regexp = new RegExp(s.escapeRegExp(highlight), 'i');\n\t\t\tif (regexp.test(message.msg)) {\n\t\t\t\thas = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\n\t\treturn has;\n\t}\n\n\tif (room.t != null && room.t === 'd') {\n\t\t// Update the other subscriptions\n\t\tRocketChat.models.Subscriptions.incUnreadOfDirectForRoomIdExcludingUserId(message.rid, message.u._id, 1);\n\t} else {\n\t\tvar mentionIds, toAll, highlightsIds, highlights;\n\n\t\tmentionIds = [];\n\t\thighlightsIds = [];\n\t\ttoAll = false;\n\t\thighlights = RocketChat.models.Users.findUsersByUsernamesWithHighlights(room.usernames, { fields: { '_id': 1, 'settings.preferences.highlights': 1 }}).fetch();\n\n\t\tif (message.mentions != null) {\n\t\t\tmessage.mentions.forEach(function(mention) {\n\t\t\t\tif (!toAll && mention._id === 'all') {\n\t\t\t\t\ttoAll = true;\n\t\t\t\t}\n\t\t\t\tif (mention._id !== message.u._id) {\n\t\t\t\t\tmentionIds.push(mention._id);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\thighlights.forEach(function(user) {\n\t\t\tif (user && user.settings && user.settings.preferences && messageContainsHighlight(message, user.settings.preferences.highlights)) {\n\t\t\t\tif (user._id !== message.u._id) {\n\t\t\t\t\thighlightsIds.push(user._id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (toAll) {\n\t\t\tRocketChat.models.Subscriptions.incUnreadForRoomIdExcludingUserId(room._id, message.u._id);\n\t\t} else if ((mentionIds && mentionIds.length > 0) || (highlightsIds && highlightsIds.length > 0)) {\n\t\t\tRocketChat.models.Subscriptions.incUnreadForRoomIdAndUserIds(room._id, _.compact(_.unique(mentionIds.concat(highlightsIds))));\n\t\t}\n\t}\n\n\t// Update all the room activity tracker fields\n\tRocketChat.models.Rooms.incMsgCountAndSetLastMessageTimestampById(message.rid, 1, message.ts);\n\n\t// Update all other subscriptions to alert their owners but witout incrementing\n\t// the unread counter, as it is only for mentions and direct messages\n\tRocketChat.models.Subscriptions.setAlertForRoomIdExcludingUserId(message.rid, message.u._id);\n\n\treturn message;\n\n}, RocketChat.callbacks.priority.LOW, 'notifyUsersOnMessage');\n","import moment from 'moment';\n\nRocketChat.callbacks.add('afterSaveMessage', function(message, room) {\n\t// skips this callback if the message was edited\n\tif (message.editedAt) {\n\t\treturn message;\n\t}\n\n\tif (message.ts && Math.abs(moment(message.ts).diff()) > 60000) {\n\t\treturn message;\n\t}\n\n\tvar emailSubject, usersToSendEmail = {};\n\tvar directMessage = room.t === 'd';\n\n\tif (directMessage) {\n\t\tusersToSendEmail[message.rid.replace(message.u._id, '')] = 1;\n\n\t\temailSubject = TAPi18n.__('Offline_DM_Email', {\n\t\t\tuser: message.u.username\n\t\t});\n\n\t} else {\n\t\tif (message.mentions) {\n\t\t\tmessage.mentions.forEach(function(mention) {\n\t\t\t\tusersToSendEmail[mention._id] = 1;\n\t\t\t});\n\t\t}\n\n\t\temailSubject = TAPi18n.__('Offline_Mention_Email', {\n\t\t\tuser: message.u.username,\n\t\t\troom: room.name\n\t\t});\n\t}\n\n\tvar getMessageLink = (room, sub) => {\n\t\tvar roomPath = RocketChat.roomTypes.getRouteLink(room.t, sub);\n\t\tvar path = Meteor.absoluteUrl(roomPath ? roomPath.replace(/^\\//, '') : '');\n\t\tvar style = [\n\t\t\t'color: #fff;',\n\t\t\t'padding: 9px 12px;',\n\t\t\t'border-radius: 4px;',\n\t\t\t'background-color: #04436a;',\n\t\t\t'text-decoration: none;'\n\t\t].join(' ');\n\t\tvar message = TAPi18n.__('Offline_Link_Message');\n\t\treturn `<p style=\"text-align:center;margin-bottom:8px;\"><a style=\"${ style }\" href=\"${ path }\">${ message }</a>`;\n\t};\n\n\tvar divisorMessage = '<hr style=\"margin: 20px auto; border: none; border-bottom: 1px solid #dddddd;\">';\n\tvar messageHTML = s.escapeHTML(message.msg);\n\n\tmessage = RocketChat.callbacks.run('renderMessage', message);\n\tif (message.tokens && message.tokens.length > 0) {\n\t\tmessage.tokens.forEach((token) => {\n\t\t\ttoken.text = token.text.replace(/([^\\$])(\\$[^\\$])/gm, '$1$$$2');\n\t\t\tmessageHTML = messageHTML.replace(token.token, token.text);\n\t\t});\n\t}\n\n\tvar header = RocketChat.placeholders.replace(RocketChat.settings.get('Email_Header') || '');\n\tvar footer = RocketChat.placeholders.replace(RocketChat.settings.get('Email_Footer') || '');\n\tmessageHTML = messageHTML.replace(/\\n/gm, '<br/>');\n\n\tRocketChat.models.Subscriptions.findWithSendEmailByRoomId(room._id).forEach((sub) => {\n\t\tswitch (sub.emailNotifications) {\n\t\t\tcase 'all':\n\t\t\t\tusersToSendEmail[sub.u._id] = 'force';\n\t\t\t\tbreak;\n\t\t\tcase 'mentions':\n\t\t\t\tif (usersToSendEmail[sub.u._id]) {\n\t\t\t\t\tusersToSendEmail[sub.u._id] = 'force';\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'nothing':\n\t\t\t\tdelete usersToSendEmail[sub.u._id];\n\t\t\t\tbreak;\n\t\t\tcase 'default':\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tvar userIdsToSendEmail = Object.keys(usersToSendEmail);\n\n\tvar defaultLink;\n\n\tvar linkByUser = {};\n\tif (RocketChat.roomTypes.hasCustomLink(room.t)) {\n\t\tRocketChat.models.Subscriptions.findByRoomIdAndUserIds(room._id, userIdsToSendEmail).forEach((sub) => {\n\t\t\tlinkByUser[sub.u._id] = getMessageLink(room, sub);\n\t\t});\n\t} else {\n\t\tdefaultLink = getMessageLink(room, { name: room.name });\n\t}\n\n\tif (userIdsToSendEmail.length > 0) {\n\t\tvar usersOfMention = RocketChat.models.Users.getUsersToSendOfflineEmail(userIdsToSendEmail).fetch();\n\n\t\tif (usersOfMention && usersOfMention.length > 0) {\n\t\t\tvar siteName = RocketChat.settings.get('Site_Name');\n\n\t\t\tusersOfMention.forEach((user) => {\n\t\t\t\tif (user.settings && user.settings.preferences && user.settings.preferences.emailNotificationMode && user.settings.preferences.emailNotificationMode === 'disabled' && usersToSendEmail[user._id] !== 'force') {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Checks if user is in the room he/she is mentioned (unless it's public channel)\n\t\t\t\tif (room.t !== 'c' && room.usernames.indexOf(user.username) === -1) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tuser.emails.some((email) => {\n\t\t\t\t\tif (email.verified) {\n\t\t\t\t\t\temail = {\n\t\t\t\t\t\t\tto: email.address,\n\t\t\t\t\t\t\tfrom: RocketChat.settings.get('From_Email'),\n\t\t\t\t\t\t\tsubject: `[${ siteName }] ${ emailSubject }`,\n\t\t\t\t\t\t\thtml: header + messageHTML + divisorMessage + (linkByUser[user._id] || defaultLink) + footer\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tMeteor.defer(() => {\n\t\t\t\t\t\t\tEmail.send(email);\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\treturn message;\n\n}, RocketChat.callbacks.priority.LOW, 'sendEmailOnMessage');\n","/* globals Push */\nimport moment from 'moment';\n\nRocketChat.callbacks.add('afterSaveMessage', function(message, room) {\n\t// skips this callback if the message was edited\n\tif (message.editedAt) {\n\t\treturn message;\n\t}\n\n\tif (message.ts && Math.abs(moment(message.ts).diff()) > 60000) {\n\t\treturn message;\n\t}\n\n\tvar user = RocketChat.models.Users.findOneById(message.u._id);\n\n\t/*\n\tIncrement unread couter if direct messages\n\t */\n\tvar indexOf = [].indexOf || function(item) {\n\t\tfor (var i = 0, l = this.length; i < l; i++) {\n\t\t\tif (i in this && this[i] === item) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t};\n\n\tvar settings, desktopMentionIds, i, j, len, len1, highlights, mentionIds, highlightsIds, usersWithHighlights, mobileMentionIds, ref, ref1, toAll, toHere, userIdsToNotify, userIdsToPushNotify, userOfMention, userOfMentionId, usersOfDesktopMentions, usersOfMentionId, usersOfMentionItem, usersOfMobileMentions;\n\n\t/**\n\t * Checks if a given user can be notified\n\t *\n\t * @param {string} id\n\t * @param {string} type - mobile|desktop\n\t *\n\t * @returns {boolean}\n     */\n\tfunction canBeNotified(id, type) {\n\t\tvar types = {\n\t\t\tmobile: [ 'dontNotifyDesktopUsers', 'alwaysNotifyDesktopUsers' ],\n\t\t\tdesktop: [ 'dontNotifyMobileUsers', 'alwaysNotifyMobileUsers' ]\n\t\t};\n\n\t\treturn (settings[types[type][0]].indexOf(id) === -1 || settings[types[type][1]].indexOf(id) !== -1);\n\t}\n\n\t/**\n\t * Checks if a message contains a user highlight\n\t *\n\t * @param {string} message\n\t * @param {array|undefined} highlights\n\t *\n\t * @returns {boolean}\n\t */\n\tfunction messageContainsHighlight(message, highlights) {\n\t\tif (! highlights || highlights.length === 0) { return false; }\n\n\t\tvar has = false;\n\t\thighlights.some(function(highlight) {\n\t\t\tvar regexp = new RegExp(s.escapeRegExp(highlight), 'i');\n\t\t\tif (regexp.test(message.msg)) {\n\t\t\t\thas = true;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\n\t\treturn has;\n\t}\n\n\tsettings = {};\n\n\tsettings.alwaysNotifyDesktopUsers = [];\n\tsettings.dontNotifyDesktopUsers = [];\n\tsettings.alwaysNotifyMobileUsers = [];\n\tsettings.dontNotifyMobileUsers = [];\n\tsettings.desktopNotificationDurations = {};\n\n\tconst notificationPreferencesByRoom = RocketChat.models.Subscriptions.findNotificationPreferencesByRoom(room._id);\n\tnotificationPreferencesByRoom.forEach(function(subscription) {\n\t\tif (subscription.desktopNotifications === 'all') {\n\t\t\tsettings.alwaysNotifyDesktopUsers.push(subscription.u._id);\n\t\t} else if (subscription.desktopNotifications === 'nothing') {\n\t\t\tsettings.dontNotifyDesktopUsers.push(subscription.u._id);\n\t\t}\n\t\tif (subscription.mobilePushNotifications === 'all') {\n\t\t\tsettings.alwaysNotifyMobileUsers.push(subscription.u._id);\n\t\t} else if (subscription.mobilePushNotifications === 'nothing') {\n\t\t\tsettings.dontNotifyMobileUsers.push(subscription.u._id);\n\t\t}\n\t\tsettings.desktopNotificationDurations[subscription.u._id] = subscription.desktopNotificationDuration;\n\t});\n\n\tuserIdsToNotify = [];\n\tuserIdsToPushNotify = [];\n\tusersWithHighlights = [];\n\n\thighlights = RocketChat.models.Users.findUsersByUsernamesWithHighlights(room.usernames, { fields: { '_id': 1, 'settings.preferences.highlights': 1 }}).fetch();\n\n\thighlights.forEach(function(user) {\n\t\tif (messageContainsHighlight(message, user.settings.preferences.highlights)) {\n\t\t\tusersWithHighlights.push(user);\n\t\t}\n\t});\n\n\tlet push_message;\n\t//Set variables depending on Push Notification settings\n\tif (RocketChat.settings.get('Push_show_message')) {\n\t\tpush_message = message.msg;\n\t} else {\n\t\tpush_message = ' ';\n\t}\n\n\tlet push_username;\n\tlet push_room;\n\tif (RocketChat.settings.get('Push_show_username_room')) {\n\t\tpush_username = user.username;\n\t\tpush_room = '#' + room.name;\n\t} else {\n\t\tpush_username = '';\n\t\tpush_room = '';\n\t}\n\n\tif ((room.t == null) || room.t === 'd') {\n\t\tuserOfMentionId = message.rid.replace(message.u._id, '');\n\t\tuserOfMention = RocketChat.models.Users.findOne({\n\t\t\t_id: userOfMentionId\n\t\t}, {\n\t\t\tfields: {\n\t\t\t\tusername: 1,\n\t\t\t\tstatusConnection: 1\n\t\t\t}\n\t\t});\n\n\t\t// Always notify Sandstorm\n\t\tif (userOfMention != null) {\n\t\t\tRocketChat.Sandstorm.notify(message, [userOfMention._id],\n\t\t\t\t'@' + user.username + ': ' + message.msg, 'privateMessage');\n\n\t\t}\n\t\tif ((userOfMention != null) && canBeNotified(userOfMentionId, 'mobile')) {\n\t\t\tRocketChat.Notifications.notifyUser(userOfMention._id, 'notification', {\n\t\t\t\ttitle: '@' + user.username,\n\t\t\t\ttext: message.msg,\n\t\t\t\tduration: settings.desktopNotificationDurations[userOfMention._id],\n\t\t\t\tpayload: {\n\t\t\t\t\t_id: message._id,\n\t\t\t\t\trid: message.rid,\n\t\t\t\t\tsender: message.u,\n\t\t\t\t\ttype: room.t,\n\t\t\t\t\tname: room.name\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif ((userOfMention != null) && canBeNotified(userOfMentionId, 'desktop')) {\n\t\t\tif (Push.enabled === true && userOfMention.statusConnection !== 'online') {\n\t\t\t\tRocketChat.PushNotification.send({\n\t\t\t\t\troomId: message.rid,\n\t\t\t\t\tusername: push_username,\n\t\t\t\t\tmessage: push_message,\n\t\t\t\t\tpayload: {\n\t\t\t\t\t\thost: Meteor.absoluteUrl(),\n\t\t\t\t\t\trid: message.rid,\n\t\t\t\t\t\tsender: message.u,\n\t\t\t\t\t\ttype: room.t,\n\t\t\t\t\t\tname: room.name\n\t\t\t\t\t},\n\t\t\t\t\tusersTo: {\n\t\t\t\t\t\tuserId: userOfMention._id\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn message;\n\t\t\t}\n\t\t}\n\n\t} else {\n\t\tmentionIds = [];\n\t\tif ((ref = message.mentions) != null) {\n\t\t\tref.forEach(function(mention) {\n\t\t\t\treturn mentionIds.push(mention._id);\n\t\t\t});\n\t\t}\n\t\ttoAll = mentionIds.indexOf('all') > -1;\n\t\ttoHere = mentionIds.indexOf('here') > -1;\n\t\tif (mentionIds.length > 0 || settings.alwaysNotifyDesktopUsers.length > 0) {\n\t\t\tdesktopMentionIds = _.union(mentionIds, settings.alwaysNotifyDesktopUsers);\n\t\t\tdesktopMentionIds = _.difference(desktopMentionIds, settings.dontNotifyDesktopUsers);\n\n\t\t\tusersOfDesktopMentions = RocketChat.models.Users.find({\n\t\t\t\t_id: {\n\t\t\t\t\t$in: desktopMentionIds\n\t\t\t\t}\n\t\t\t}, {\n\t\t\t\tfields: {\n\t\t\t\t\t_id: 1,\n\t\t\t\t\tusername: 1,\n\t\t\t\t\tactive: 1\n\t\t\t\t}\n\t\t\t}).fetch();\n\t\t\tif (room.t === 'c' && !toAll) {\n\t\t\t\tconst callJoin = function(usersOfMentionItem) {\n\t\t\t\t\tif (usersOfMentionItem.active) {\n\t\t\t\t\t\tMeteor.runAsUser(usersOfMentionItem._id, function() {\n\t\t\t\t\t\t\treturn Meteor.call('joinRoom', room._id);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tfor (i = 0, len = usersOfDesktopMentions.length; i < len; i++) {\n\t\t\t\t\tusersOfMentionItem = usersOfDesktopMentions[i];\n\t\t\t\t\tif (room.usernames.indexOf(usersOfMentionItem.username) === -1) {\n\t\t\t\t\t\tcallJoin(usersOfMentionItem);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (room.t !== 'c') {\n\t\t\t\tusersOfDesktopMentions = _.reject(usersOfDesktopMentions, (usersOfMentionItem) => {\n\t\t\t\t\treturn room.usernames.indexOf(usersOfMentionItem.username) === -1;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tuserIdsToNotify = _.pluck(usersOfDesktopMentions, '_id');\n\t\t}\n\n\t\tif (mentionIds.length > 0 || settings.alwaysNotifyMobileUsers.length > 0) {\n\t\t\tmobileMentionIds = _.union(mentionIds, settings.alwaysNotifyMobileUsers);\n\t\t\tmobileMentionIds = _.difference(mobileMentionIds, settings.dontNotifyMobileUsers);\n\n\t\t\tusersOfMobileMentions = RocketChat.models.Users.find({\n\t\t\t\t_id: {\n\t\t\t\t\t$in: mobileMentionIds\n\t\t\t\t}\n\t\t\t}, {\n\t\t\t\tfields: {\n\t\t\t\t\t_id: 1,\n\t\t\t\t\tusername: 1,\n\t\t\t\t\tstatusConnection: 1\n\t\t\t\t}\n\t\t\t}).fetch();\n\n\t\t\tif (room.t !== 'c') {\n\t\t\t\tusersOfMobileMentions = _.reject(usersOfMobileMentions, (usersOfMentionItem) => {\n\t\t\t\t\treturn room.usernames.indexOf(usersOfMentionItem.username) === -1;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tuserIdsToPushNotify = _.pluck(_.filter(usersOfMobileMentions, function(user) {\n\t\t\t\treturn user.statusConnection !== 'online';\n\t\t\t}), '_id');\n\t\t}\n\n\t\tif ((toAll || toHere) && ((ref1 = room.usernames) != null ? ref1.length : void 0) > 0) {\n\t\t\tRocketChat.models.Users.find({\n\t\t\t\tusername: {\n\t\t\t\t\t$in: room.usernames\n\t\t\t\t},\n\t\t\t\t_id: {\n\t\t\t\t\t$ne: user._id\n\t\t\t\t}\n\t\t\t}, {\n\t\t\t\tfields: {\n\t\t\t\t\t_id: 1,\n\t\t\t\t\tusername: 1,\n\t\t\t\t\tstatus: 1,\n\t\t\t\t\tstatusConnection: 1\n\t\t\t\t}\n\t\t\t}).forEach(function(user) {\n\t\t\t\tvar ref2, ref3, ref4;\n\t\t\t\tif (((ref2 = user.status) === 'online' || ref2 === 'away' || ref2 === 'busy') && (ref3 = user._id, indexOf.call(settings.dontNotifyDesktopUsers, ref3) < 0)) {\n\t\t\t\t\tuserIdsToNotify.push(user._id);\n\t\t\t\t}\n\t\t\t\tif (toAll && user.statusConnection !== 'online' && (ref4 = user._id, indexOf.call(settings.dontNotifyMobileUsers, ref4) < 0)) {\n\t\t\t\t\treturn userIdsToPushNotify.push(user._id);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (usersWithHighlights.length > 0) {\n\t\t\thighlightsIds = _.pluck(usersWithHighlights, '_id');\n\t\t\tuserIdsToNotify = userIdsToNotify.concat(highlightsIds);\n\t\t\tuserIdsToPushNotify = userIdsToPushNotify.concat(highlightsIds);\n\t\t}\n\n\t\tuserIdsToNotify = _.without(_.compact(_.unique(userIdsToNotify)), message.u._id);\n\t\tuserIdsToPushNotify = _.without(_.compact(_.unique(userIdsToPushNotify)), message.u._id);\n\n\t\tif (userIdsToNotify.length > 0) {\n\t\t\tfor (j = 0, len1 = userIdsToNotify.length; j < len1; j++) {\n\t\t\t\tusersOfMentionId = userIdsToNotify[j];\n\t\t\t\tlet title = '@' + user.username;\n\t\t\t\tif (room.name) {\n\t\t\t\t\ttitle += ' @ #' + room.name;\n\t\t\t\t}\n\t\t\t\tRocketChat.Notifications.notifyUser(usersOfMentionId, 'notification', {\n\t\t\t\t\ttitle: title,\n\t\t\t\t\ttext: message.msg,\n\t\t\t\t\tduration: settings.desktopNotificationDurations[usersOfMentionId],\n\t\t\t\t\tpayload: {\n\t\t\t\t\t\t_id: message._id,\n\t\t\t\t\t\trid: message.rid,\n\t\t\t\t\t\tsender: message.u,\n\t\t\t\t\t\ttype: room.t,\n\t\t\t\t\t\tname: room.name\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (userIdsToPushNotify.length > 0) {\n\t\t\tif (Push.enabled === true) {\n\t\t\t\tRocketChat.PushNotification.send({\n\t\t\t\t\troomId: message.rid,\n\t\t\t\t\troomName: push_room,\n\t\t\t\t\tusername: push_username,\n\t\t\t\t\tmessage: push_message,\n\t\t\t\t\tpayload: {\n\t\t\t\t\t\thost: Meteor.absoluteUrl(),\n\t\t\t\t\t\trid: message.rid,\n\t\t\t\t\t\tsender: message.u,\n\t\t\t\t\t\ttype: room.t,\n\t\t\t\t\t\tname: room.name\n\t\t\t\t\t},\n\t\t\t\t\tusersTo: {\n\t\t\t\t\t\tuserId: {\n\t\t\t\t\t\t\t$in: userIdsToPushNotify\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tconst allUserIdsToNotify = _.unique(userIdsToNotify.concat(userIdsToPushNotify));\n\t\tif (room.t === 'p') {\n\t\t\tRocketChat.Sandstorm.notify(message, allUserIdsToNotify,\n\t\t\t\t'@' + user.username + ': ' + message.msg, 'privateMessage');\n\t\t} else {\n\t\t\tRocketChat.Sandstorm.notify(message, allUserIdsToNotify,\n\t\t\t\t'@' + user.username + ': ' + message.msg, 'message');\n\t\t}\n\t}\n\n\treturn message;\n\n}, RocketChat.callbacks.priority.LOW, 'sendNotificationOnMessage');\n","const dns = Npm.require('dns');\n\nvar emailDomainBlackList = [];\nvar emailDomainWhiteList = [];\nvar useDefaultBlackList = false;\nvar useDNSDomainCheck = false;\n\nRocketChat.settings.get('Accounts_BlockedDomainsList', function(key, value) {\n\temailDomainBlackList = _.map(value.split(','), (domain) => domain.trim());\n});\nRocketChat.settings.get('Accounts_AllowedDomainsList', function(key, value) {\n\temailDomainWhiteList = _.map(value.split(','), (domain) => domain.trim());\n});\nRocketChat.settings.get('Accounts_UseDefaultBlockedDomainsList', function(key, value) {\n\tuseDefaultBlackList = value;\n});\nRocketChat.settings.get('Accounts_UseDNSDomainCheck', function(key, value) {\n\tuseDNSDomainCheck = value;\n});\n\nRocketChat.validateEmailDomain = function(email) {\n\tconst emailValidation = /^[a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\n\tif (!emailValidation.test(email)) {\n\t\tthrow new Meteor.Error('error-invalid-email', 'Invalid email ' + email, { function: 'RocketChat.validateEmailDomain', email: email });\n\t}\n\n\tconst emailDomain = email.substr(email.lastIndexOf('@') + 1);\n\n\t// if not in whitelist\n\tif (emailDomainWhiteList.indexOf(emailDomain) === -1) {\n\t\tif (emailDomainBlackList.indexOf(emailDomain) !== -1 || (useDefaultBlackList && RocketChat.emailDomainDefaultBlackList.indexOf(emailDomain) !== -1)) {\n\t\t\tthrow new Meteor.Error('error-email-domain-blacklisted', 'The email domain is blacklisted', { function: 'RocketChat.validateEmailDomain' });\n\t\t}\n\t}\n\n\tif (useDNSDomainCheck) {\n\t\ttry {\n\t\t\tMeteor.wrapAsync(dns.resolveMx)(emailDomain);\n\t\t} catch (e) {\n\t\t\tthrow new Meteor.Error('error-invalid-domain', 'Invalid domain', { function: 'RocketChat.validateEmailDomain' });\n\t\t}\n\t}\n};\n","import fs from 'fs';\n\nfunction hasDockerEnv() {\n\ttry {\n\t\tfs.statSync('/.dockerenv');\n\t\treturn true;\n\t} catch (err) {\n\t\treturn false;\n\t}\n}\n\nfunction hasDockerCGroup() {\n\ttry {\n\t\treturn fs.readFileSync('/proc/self/cgroup', 'utf8').indexOf('docker') !== -1;\n\t} catch (err) {\n\t\treturn false;\n\t}\n}\n\nfunction check() {\n\treturn hasDockerEnv() || hasDockerCGroup();\n}\n\nlet isDocker;\nRocketChat.isDocker = function() {\n\tif (isDocker === undefined) {\n\t\tisDocker = check();\n\t}\n\n\treturn isDocker;\n};\n","RocketChat.addUserToDefaultChannels = function(user, silenced) {\n\tRocketChat.callbacks.run('beforeJoinDefaultChannels', user);\n\tconst defaultRooms = RocketChat.models.Rooms.findByDefaultAndTypes(true, ['c', 'p'], {fields: {usernames: 0}}).fetch();\n\tdefaultRooms.forEach((room) => {\n\n\t\t// put user in default rooms\n\t\tconst muted = room.ro && !RocketChat.authz.hasPermission(user._id, 'post-readonly');\n\t\tRocketChat.models.Rooms.addUsernameById(room._id, user.username, muted);\n\n\t\tif (!RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(room._id, user._id)) {\n\n\t\t\t// Add a subscription to this user\n\t\t\tRocketChat.models.Subscriptions.createWithRoomAndUser(room, user, {\n\t\t\t\tts: new Date(),\n\t\t\t\topen: true,\n\t\t\t\talert: true,\n\t\t\t\tunread: 1\n\t\t\t});\n\n\t\t\t// Insert user joined message\n\t\t\tif (!silenced) {\n\t\t\t\tRocketChat.models.Messages.createUserJoinWithRoomIdAndUser(room._id, user);\n\t\t\t}\n\t\t}\n\t});\n};\n","RocketChat.addUserToRoom = function(rid, user, inviter, silenced) {\n\tconst now = new Date();\n\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\n\t// Check if user is already in room\n\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, user._id);\n\tif (subscription) {\n\t\treturn;\n\t}\n\n\tif (room.t === 'c' || room.t === 'p') {\n\t\tRocketChat.callbacks.run('beforeJoinRoom', user, room);\n\t}\n\n\tvar muted = room.ro && !RocketChat.authz.hasPermission(user._id, 'post-readonly');\n\tRocketChat.models.Rooms.addUsernameById(rid, user.username, muted);\n\tRocketChat.models.Subscriptions.createWithRoomAndUser(room, user, {\n\t\tts: now,\n\t\topen: true,\n\t\talert: true,\n\t\tunread: 1\n\t});\n\n\tif (!silenced) {\n\t\tif (inviter) {\n\t\t\tRocketChat.models.Messages.createUserAddedWithRoomIdAndUser(rid, user, {\n\t\t\t\tts: now,\n\t\t\t\tu: {\n\t\t\t\t\t_id: inviter._id,\n\t\t\t\t\tusername: inviter.username\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tRocketChat.models.Messages.createUserJoinWithRoomIdAndUser(rid, user, { ts: now });\n\t\t}\n\t}\n\n\tif (room.t === 'c' || room.t === 'p') {\n\t\tMeteor.defer(function() {\n\t\t\tRocketChat.callbacks.run('afterJoinRoom', user, room);\n\t\t});\n\t}\n\n\treturn true;\n};\n","RocketChat.archiveRoom = function(rid) {\n\tRocketChat.models.Rooms.archiveById(rid);\n\tRocketChat.models.Subscriptions.archiveByRoomId(rid);\n\n\tRocketChat.callbacks.run('afterRoomArchived', RocketChat.models.Rooms.findOneById(rid), Meteor.user());\n};\n","RocketChat.checkEmailAvailability = function(email) {\n\treturn !Meteor.users.findOne({ 'emails.address': { $regex : new RegExp('^' + s.trim(s.escapeRegExp(email)) + '$', 'i') } });\n};\n","/* globals RocketChat */\nRocketChat.createRoom = function(type, name, owner, members, readOnly, extraData={}) {\n\tname = s.trim(name);\n\towner = s.trim(owner);\n\tmembers = [].concat(members);\n\n\tif (!name) {\n\t\tthrow new Meteor.Error('error-invalid-name', 'Invalid name', { function: 'RocketChat.createRoom' });\n\t}\n\n\towner = RocketChat.models.Users.findOneByUsername(owner, { fields: { username: 1 }});\n\tif (!owner) {\n\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { function: 'RocketChat.createRoom' });\n\t}\n\n\tlet nameValidation;\n\ttry {\n\t\tnameValidation = new RegExp('^' + RocketChat.settings.get('UTF8_Names_Validation') + '$');\n\t} catch (error) {\n\t\tnameValidation = new RegExp('^[0-9a-zA-Z-_.]+$');\n\t}\n\n\tif (!nameValidation.test(name)) {\n\t\tthrow new Meteor.Error('error-invalid-name', 'Invalid name', { function: 'RocketChat.createRoom' });\n\t}\n\n\tconst now = new Date();\n\tif (!_.contains(members, owner.username)) {\n\t\tmembers.push(owner.username);\n\t}\n\n\t// avoid duplicate names\n\tlet room = RocketChat.models.Rooms.findOneByName(name);\n\tif (room) {\n\t\tif (room.archived) {\n\t\t\tthrow new Meteor.Error('error-archived-duplicate-name', 'There\\'s an archived channel with name ' + name, { function: 'RocketChat.createRoom', room_name: name });\n\t\t} else {\n\t\t\tthrow new Meteor.Error('error-duplicate-channel-name', 'A channel with name \\'' + name + '\\' exists', { function: 'RocketChat.createRoom', room_name: name });\n\t\t}\n\t}\n\n\tif (type === 'c') {\n\t\tRocketChat.callbacks.run('beforeCreateChannel', owner, {\n\t\t\tt: 'c',\n\t\t\tname: name,\n\t\t\tts: now,\n\t\t\tro: readOnly === true,\n\t\t\tsysMes: readOnly !== true,\n\t\t\tusernames: members,\n\t\t\tu: {\n\t\t\t\t_id: owner._id,\n\t\t\t\tusername: owner.username\n\t\t\t}\n\t\t});\n\t}\n\n\textraData = Object.assign({}, extraData, {\n\t\tts: now,\n\t\tro: readOnly === true,\n\t\tsysMes: readOnly !== true\n\t});\n\n\troom = RocketChat.models.Rooms.createWithTypeNameUserAndUsernames(type, name, owner, members, extraData);\n\n\tfor (const username of members) {\n\t\tconst member = RocketChat.models.Users.findOneByUsername(username, { fields: { username: 1 }});\n\t\tif (!member) {\n\t\t\tcontinue;\n\t\t}\n\n\t\t// make all room members muted by default, unless they have the post-readonly permission\n\t\tif (readOnly === true && !RocketChat.authz.hasPermission(member._id, 'post-readonly')) {\n\t\t\tRocketChat.models.Rooms.muteUsernameByRoomId(room._id, username);\n\t\t}\n\n\t\tconst extra = { open: true };\n\n\t\tif (username === owner.username) {\n\t\t\textra.ls = now;\n\t\t}\n\n\t\tRocketChat.models.Subscriptions.createWithRoomAndUser(room, member, extra);\n\t}\n\n\tRocketChat.authz.addUserRoles(owner._id, ['owner'], room._id);\n\n\tif (type === 'c') {\n\t\tMeteor.defer(() => {\n\t\t\tRocketChat.callbacks.run('afterCreateChannel', owner, room);\n\t\t});\n\t} else if (type === 'p') {\n\t\tMeteor.defer(() => {\n\t\t\tRocketChat.callbacks.run('afterCreatePrivateGroup', owner, room);\n\t\t});\n\t}\n\n\treturn {\n\t\trid: room._id\n\t};\n};\n","/* globals FileUpload */\nRocketChat.deleteMessage = function(message, user) {\n\tconst keepHistory = RocketChat.settings.get('Message_KeepHistory');\n\tconst showDeletedStatus = RocketChat.settings.get('Message_ShowDeletedStatus');\n\tlet deletedMsg;\n\n\tif (keepHistory) {\n\t\tif (showDeletedStatus) {\n\t\t\tRocketChat.models.Messages.cloneAndSaveAsHistoryById(message._id);\n\t\t} else {\n\t\t\tRocketChat.models.Messages.setHiddenById(message._id, true);\n\t\t}\n\n\t\tif (message.file && message.file._id) {\n\t\t\tRocketChat.models.Uploads.update(message.file._id, { $set: { _hidden: true } });\n\t\t}\n\t} else {\n\t\tif (!showDeletedStatus) {\n\t\t\tdeletedMsg = RocketChat.models.Messages.findOneById(message._id);\n\t\t\tRocketChat.models.Messages.removeById(message._id);\n\t\t}\n\n\t\tif (message.file && message.file._id) {\n\t\t\tFileUpload.delete(message.file._id);\n\t\t}\n\n\t\tMeteor.defer(function() {\n\t\t\tRocketChat.callbacks.run('afterDeleteMessage', deletedMsg);\n\t\t});\n\t}\n\n\tif (showDeletedStatus) {\n\t\tRocketChat.models.Messages.setAsDeletedByIdAndUser(message._id, user);\n\t} else {\n\t\tRocketChat.Notifications.notifyRoom(message.rid, 'deleteMessage', { _id: message._id });\n\t}\n};\n","/* globals RocketChat */\nRocketChat.deleteUser = function(userId) {\n\tconst user = RocketChat.models.Users.findOneById(userId);\n\n\tRocketChat.models.Messages.removeByUserId(userId); // Remove user messages\n\tRocketChat.models.Subscriptions.findByUserId(userId).forEach((subscription) => {\n\t\tconst room = RocketChat.models.Rooms.findOneById(subscription.rid);\n\t\tif (room) {\n\t\t\tif (room.t !== 'c' && room.usernames.length === 1) {\n\t\t\t\tRocketChat.models.Rooms.removeById(subscription.rid); // Remove non-channel rooms with only 1 user (the one being deleted)\n\t\t\t}\n\t\t\tif (room.t === 'd') {\n\t\t\t\tRocketChat.models.Subscriptions.removeByRoomId(subscription.rid);\n\t\t\t\tRocketChat.models.Messages.removeByRoomId(subscription.rid);\n\t\t\t}\n\t\t}\n\t});\n\n\tRocketChat.models.Subscriptions.removeByUserId(userId); // Remove user subscriptions\n\tRocketChat.models.Rooms.removeByTypeContainingUsername('d', user.username); // Remove direct rooms with the user\n\tRocketChat.models.Rooms.removeUsernameFromAll(user.username); // Remove user from all other rooms\n\n\t// removes user's avatar\n\tif (user.avatarOrigin === 'upload' || user.avatarOrigin === 'url') {\n\t\tRocketChatFileAvatarInstance.deleteFile(encodeURIComponent(user.username + '.jpg'));\n\t}\n\n\tRocketChat.models.Integrations.disableByUserId(userId); // Disables all the integrations which rely on the user being deleted.\n\n\tRocketChat.models.Users.removeById(userId); // Remove user from users database\n};\n","/* globals RocketChat */\nRocketChat.getFullUserData = function({userId, filter, limit}) {\n\tlet fields = {\n\t\tname: 1,\n\t\tusername: 1,\n\t\tstatus: 1,\n\t\tutcOffset: 1,\n\t\ttype: 1,\n\t\tactive: 1\n\t};\n\n\tif (RocketChat.authz.hasPermission(userId, 'view-full-other-user-info')) {\n\t\tfields = _.extend(fields, {\n\t\t\temails: 1,\n\t\t\tphone: 1,\n\t\t\tstatusConnection: 1,\n\t\t\tcreatedAt: 1,\n\t\t\tlastLogin: 1,\n\t\t\tservices: 1,\n\t\t\trequirePasswordChange: 1,\n\t\t\trequirePasswordChangeReason: 1,\n\t\t\troles: 1,\n\t\t\tcustomFields: 1\n\t\t});\n\t} else if (limit !== 0) {\n\t\tlimit = 1;\n\t}\n\n\tfilter = s.trim(filter);\n\n\tif (!filter && limit === 1) {\n\t\treturn undefined;\n\t}\n\n\tconst options = {\n\t\tfields: fields,\n\t\tlimit: limit,\n\t\tsort: { username: 1 }\n\t};\n\n\tif (filter) {\n\t\tif (limit === 1) {\n\t\t\treturn RocketChat.models.Users.findByUsername(filter, options);\n\t\t} else {\n\t\t\tconst filterReg = new RegExp(s.escapeRegExp(filter), 'i');\n\t\t\treturn RocketChat.models.Users.findByUsernameNameOrEmailAddress(filterReg, options);\n\t\t}\n\t}\n\n\treturn RocketChat.models.Users.find({}, options);\n};\n","/* globals RocketChat */\nRocketChat.getRoomByNameOrIdWithOptionToJoin = function _getRoomByNameOrIdWithOptionToJoin({ currentUserId, nameOrId, type='', tryDirectByUserIdOnly=false, joinChannel=true, errorOnEmpty=true }) {\n\tlet room;\n\n\t//If the nameOrId starts with #, then let's try to find a channel or group\n\tif (nameOrId.startsWith('#')) {\n\t\tnameOrId = nameOrId.substring(1);\n\t\troom = RocketChat.models.Rooms.findOneByIdOrName(nameOrId);\n\t} else if (nameOrId.startsWith('@') || type === 'd') {\n\t\t//If the nameOrId starts with @ OR type is 'd', then let's try just a direct message\n\t\tnameOrId = nameOrId.replace('@', '');\n\n\t\tlet roomUser;\n\t\tif (tryDirectByUserIdOnly) {\n\t\t\troomUser = RocketChat.models.Users.findOneById(nameOrId);\n\t\t} else {\n\t\t\troomUser = RocketChat.models.Users.findOne({\n\t\t\t\t$or: [{ _id: nameOrId }, { username: nameOrId }]\n\t\t\t});\n\t\t}\n\n\t\tconst rid = _.isObject(roomUser) ? [currentUserId, roomUser._id].sort().join('') : nameOrId;\n\t\troom = RocketChat.models.Rooms.findOneById(rid);\n\n\t\t//If the room hasn't been found yet, let's try some more\n\t\tif (!_.isObject(room)) {\n\t\t\t//If the roomUser wasn't found, then there's no destination to point towards\n\t\t\t//so return out based upon errorOnEmpty\n\t\t\tif (!_.isObject(roomUser)) {\n\t\t\t\tif (errorOnEmpty) {\n\t\t\t\t\tthrow new Meteor.Error('invalid-channel');\n\t\t\t\t} else {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\troom = Meteor.runAsUser(currentUserId, function() {\n\t\t\t\tconst {rid} = Meteor.call('createDirectMessage', roomUser.username);\n\t\t\t\treturn RocketChat.models.Rooms.findOneById(rid);\n\t\t\t});\n\t\t}\n\t} else {\n\t\t//Otherwise, we'll treat this as a channel or group.\n\t\troom = RocketChat.models.Rooms.findOneByIdOrName(nameOrId);\n\t}\n\n\t//If no room was found, handle the room return based upon errorOnEmpty\n\tif (!room && errorOnEmpty) {\n\t\tthrow new Meteor.Error('invalid-channel');\n\t} else if (!room) {\n\t\treturn;\n\t}\n\n\t//If a room was found and they provided a type to search, then check\n\t//and if the type found isn't what we're looking for then handle\n\t//the return based upon errorOnEmpty\n\tif (type && room.t !== type) {\n\t\tif (errorOnEmpty) {\n\t\t\tthrow new Meteor.Error('invalid-channel');\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n\n\t//If the room type is channel and joinChannel has been passed, try to join them\n\t//if they can't join the room, this will error out!\n\tif (room.t === 'c' && joinChannel) {\n\t\tconst sub = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(room._id, currentUserId);\n\n\t\tif (!sub) {\n\t\t\tMeteor.runAsUser(currentUserId, function() {\n\t\t\t\treturn Meteor.call('joinRoom', room._id);\n\t\t\t});\n\t\t}\n\t}\n\n\treturn room;\n};\n","RocketChat.removeUserFromRoom = function(rid, user) {\n\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\n\tif (room) {\n\t\tRocketChat.callbacks.run('beforeLeaveRoom', user, room);\n\t\tRocketChat.models.Rooms.removeUsernameById(rid, user.username);\n\n\t\tif (room.usernames.indexOf(user.username) !== -1) {\n\t\t\tconst removedUser = user;\n\t\t\tRocketChat.models.Messages.createUserLeaveWithRoomIdAndUser(rid, removedUser);\n\t\t}\n\n\t\tif (room.t === 'l') {\n\t\t\tRocketChat.models.Messages.createCommandWithRoomIdAndUser('survey', rid, user);\n\t\t}\n\n\t\tRocketChat.models.Subscriptions.removeByRoomIdAndUserId(rid, user._id);\n\n\t\tMeteor.defer(function() {\n\t\t\tRocketChat.callbacks.run('afterLeaveRoom', user, room);\n\t\t});\n\t}\n};\n","/* globals Gravatar */\nRocketChat.saveUser = function(userId, userData) {\n\tconst user = RocketChat.models.Users.findOneById(userId);\n\tconst existingRoles = _.pluck(RocketChat.authz.getRoles(), '_id');\n\n\tif (userData._id && userId !== userData._id && !RocketChat.authz.hasPermission(userId, 'edit-other-user-info')) {\n\t\tthrow new Meteor.Error('error-action-not-allowed', 'Editing user is not allowed', { method: 'insertOrUpdateUser', action: 'Editing_user' });\n\t}\n\n\tif (!userData._id && !RocketChat.authz.hasPermission(userId, 'create-user')) {\n\t\tthrow new Meteor.Error('error-action-not-allowed', 'Adding user is not allowed', { method: 'insertOrUpdateUser', action: 'Adding_user' });\n\t}\n\n\tif (userData.roles && _.difference(userData.roles, existingRoles).length > 0) {\n\t\tthrow new Meteor.Error('error-action-not-allowed', 'The field Roles consist invalid role name', { method: 'insertOrUpdateUser', action: 'Assign_role' });\n\t}\n\n\tif (userData.roles && _.indexOf(userData.roles, 'admin') >= 0 && !RocketChat.authz.hasPermission(userId, 'assign-admin-role')) {\n\t\tthrow new Meteor.Error('error-action-not-allowed', 'Assigning admin is not allowed', { method: 'insertOrUpdateUser', action: 'Assign_admin' });\n\t}\n\n\tif (!userData._id && !s.trim(userData.name)) {\n\t\tthrow new Meteor.Error('error-the-field-is-required', 'The field Name is required', { method: 'insertOrUpdateUser', field: 'Name' });\n\t}\n\n\tif (!userData._id && !s.trim(userData.username)) {\n\t\tthrow new Meteor.Error('error-the-field-is-required', 'The field Username is required', { method: 'insertOrUpdateUser', field: 'Username' });\n\t}\n\n\tlet nameValidation;\n\n\ttry {\n\t\tnameValidation = new RegExp('^' + RocketChat.settings.get('UTF8_Names_Validation') + '$');\n\t} catch (e) {\n\t\tnameValidation = new RegExp('^[0-9a-zA-Z-_.]+$');\n\t}\n\n\tif (userData.username && !nameValidation.test(userData.username)) {\n\t\tthrow new Meteor.Error('error-input-is-not-a-valid-field', `${_.escape(userData.username)} is not a valid username`, { method: 'insertOrUpdateUser', input: userData.username, field: 'Username' });\n\t}\n\n\tif (!userData._id && !userData.password) {\n\t\tthrow new Meteor.Error('error-the-field-is-required', 'The field Password is required', { method: 'insertOrUpdateUser', field: 'Password' });\n\t}\n\n\tif (!userData._id) {\n\t\tif (!RocketChat.checkUsernameAvailability(userData.username)) {\n\t\t\tthrow new Meteor.Error('error-field-unavailable', `${_.escape(userData.username)} is already in use :(`, { method: 'insertOrUpdateUser', field: userData.username });\n\t\t}\n\n\t\tif (userData.email && !RocketChat.checkEmailAvailability(userData.email)) {\n\t\t\tthrow new Meteor.Error('error-field-unavailable', `${_.escape(userData.email)} is already in use :(`, { method: 'insertOrUpdateUser', field: userData.email });\n\t\t}\n\n\t\tRocketChat.validateEmailDomain(userData.email);\n\n\t\t// insert user\n\t\tconst createUser = {\n\t\t\tusername: userData.username,\n\t\t\tpassword: userData.password,\n\t\t\tjoinDefaultChannels: userData.joinDefaultChannels\n\t\t};\n\t\tif (userData.email) {\n\t\t\tcreateUser.email = userData.email;\n\t\t}\n\n\t\tconst _id = Accounts.createUser(createUser);\n\n\t\tconst updateUser = {\n\t\t\t$set: {\n\t\t\t\tname: userData.name,\n\t\t\t\troles: userData.roles || ['user']\n\t\t\t}\n\t\t};\n\n\t\tif (userData.requirePasswordChange) {\n\t\t\tupdateUser.$set.requirePasswordChange = userData.requirePasswordChange;\n\t\t}\n\n\t\tif (userData.verified) {\n\t\t\tupdateUser.$set['emails.0.verified'] = true;\n\t\t}\n\n\t\tMeteor.users.update({ _id: _id }, updateUser);\n\n\t\tif (userData.sendWelcomeEmail) {\n\t\t\tconst header = RocketChat.placeholders.replace(RocketChat.settings.get('Email_Header') || '');\n\t\t\tconst footer = RocketChat.placeholders.replace(RocketChat.settings.get('Email_Footer') || '');\n\n\t\t\tlet subject, html;\n\n\t\t\tif (RocketChat.settings.get('Accounts_UserAddedEmail_Customized')) {\n\t\t\t\tsubject = RocketChat.settings.get('Accounts_UserAddedEmailSubject');\n\t\t\t\thtml = RocketChat.settings.get('Accounts_UserAddedEmail');\n\t\t\t} else {\n\t\t\t\tsubject = TAPi18n.__('Accounts_UserAddedEmailSubject_Default', { lng: user.language || RocketChat.settings.get('language') || 'en' });\n\t\t\t\thtml = TAPi18n.__('Accounts_UserAddedEmail_Default', { lng: user.language || RocketChat.settings.get('language') || 'en' });\n\t\t\t}\n\n\t\t\tsubject = RocketChat.placeholders.replace(subject);\n\t\t\thtml = RocketChat.placeholders.replace(html, {\n\t\t\t\tname: userData.name,\n\t\t\t\temail: userData.email,\n\t\t\t\tpassword: userData.password\n\t\t\t});\n\n\t\t\tconst email = {\n\t\t\t\tto: userData.email,\n\t\t\t\tfrom: RocketChat.settings.get('From_Email'),\n\t\t\t\tsubject: subject,\n\t\t\t\thtml: header + html + footer\n\t\t\t};\n\n\t\t\tMeteor.defer(function() {\n\t\t\t\ttry {\n\t\t\t\t\tEmail.send(email);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tthrow new Meteor.Error('error-email-send-failed', 'Error trying to send email: ' + error.message, { function: 'RocketChat.saveUser', message: error.message });\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tuserData._id = _id;\n\n\t\tif (RocketChat.settings.get('Accounts_SetDefaultAvatar') === true && userData.email) {\n\t\t\tconst gravatarUrl = Gravatar.imageUrl(userData.email, {default: '404', size: 200, secure: true});\n\n\t\t\ttry {\n\t\t\t\tRocketChat.setUserAvatar(userData, gravatarUrl, '', 'url');\n\t\t\t} catch (e) {\n\t\t\t\t//Ignore this error for now, as it not being successful isn't bad\n\t\t\t}\n\t\t}\n\n\t\treturn _id;\n\t} else {\n\t\t// update user\n\t\tif (userData.username) {\n\t\t\tRocketChat.setUsername(userData._id, userData.username);\n\t\t}\n\n\t\tif (userData.email) {\n\t\t\tRocketChat.setEmail(userData._id, userData.email);\n\t\t}\n\n\t\tif (userData.password && userData.password.trim() && RocketChat.authz.hasPermission(userId, 'edit-other-user-password')) {\n\t\t\tAccounts.setPassword(userData._id, userData.password.trim());\n\t\t}\n\n\t\tconst updateUser = {\n\t\t\t$set: {}\n\t\t};\n\n\t\tif (userData.name) {\n\t\t\tupdateUser.$set.name = userData.name;\n\t\t}\n\n\t\tif (userData.roles) {\n\t\t\tupdateUser.$set.roles = userData.roles;\n\t\t}\n\n\t\tif (userData.requirePasswordChange) {\n\t\t\tupdateUser.$set.requirePasswordChange = userData.requirePasswordChange;\n\t\t}\n\n\t\tif (userData.verified) {\n\t\t\tupdateUser.$set['emails.0.verified'] = userData.verified;\n\t\t}\n\n\t\tMeteor.users.update({ _id: userData._id }, updateUser);\n\n\t\treturn true;\n\t}\n};\n","RocketChat.saveCustomFields = function(userId, formData) {\n\tif (s.trim(RocketChat.settings.get('Accounts_CustomFields')) !== '') {\n\t\tlet customFieldsMeta;\n\t\ttry {\n\t\t\tcustomFieldsMeta = JSON.parse(RocketChat.settings.get('Accounts_CustomFields'));\n\t\t} catch (e) {\n\t\t\tthrow new Meteor.Error('error-invalid-customfield-json', 'Invalid JSON for Custom Fields');\n\t\t}\n\n\t\tconst customFields = {};\n\n\t\tObject.keys(customFieldsMeta).forEach((fieldName) => {\n\t\t\tconst field = customFieldsMeta[fieldName];\n\n\t\t\tcustomFields[fieldName] = formData[fieldName];\n\t\t\tif (field.required && !formData[fieldName]) {\n\t\t\t\tthrow new Meteor.Error('error-user-registration-custom-field', `Field ${fieldName} is required`, { method: 'registerUser' });\n\t\t\t}\n\n\t\t\tif (field.type === 'select' && field.options.indexOf(formData[fieldName]) === -1) {\n\t\t\t\tthrow new Meteor.Error('error-user-registration-custom-field', `Value for field ${fieldName} is invalid`, { method: 'registerUser' });\n\t\t\t}\n\n\t\t\tif (field.maxLength && formData[fieldName].length > field.maxLength) {\n\t\t\t\tthrow new Meteor.Error('error-user-registration-custom-field', `Max length of field ${fieldName} ${field.maxLength}`, { method: 'registerUser' });\n\t\t\t}\n\n\t\t\tif (field.minLength && formData[fieldName].length < field.minLength) {\n\t\t\t\tthrow new Meteor.Error('error-user-registration-custom-field', `Min length of field ${fieldName} ${field.minLength}`, { method: 'registerUser' });\n\t\t\t}\n\t\t});\n\n\t\t// for fieldName, field of customFieldsMeta\n\t\tRocketChat.models.Users.setCustomFields(userId, customFields);\n\n\t\tObject.keys(customFields).forEach((fieldName) => {\n\t\t\tif (!customFieldsMeta[fieldName].modifyRecordField) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst modifyRecordField = customFieldsMeta[fieldName].modifyRecordField;\n\t\t\tconst update = {};\n\t\t\tif (modifyRecordField.array) {\n\t\t\t\tupdate.$addToSet = {};\n\t\t\t\tupdate.$addToSet[modifyRecordField.field] = customFields[fieldName];\n\t\t\t} else {\n\t\t\t\tupdate.$set = {};\n\t\t\t\tupdate.$set[modifyRecordField.field] = customFields[fieldName];\n\t\t\t}\n\n\t\t\tRocketChat.models.Users.update(userId, update);\n\t\t});\n\n\t\treturn true;\n\t}\n};\n","RocketChat.setUserAvatar = function(user, dataURI, contentType, service) {\n\tlet encoding, image;\n\n\tif (service === 'initials') {\n\t\treturn RocketChat.models.Users.setAvatarOrigin(user._id, service);\n\t} else if (service === 'url') {\n\t\tlet result = null;\n\n\t\ttry {\n\t\t\tresult = HTTP.get(dataURI, { npmRequestOptions: {encoding: 'binary'} });\n\t\t} catch (error) {\n\t\t\tif (error.response.statusCode !== 404) {\n\t\t\t\tconsole.log(`Error while handling the setting of the avatar from a url (${dataURI}) for ${user.username}:`, error);\n\t\t\t\tthrow new Meteor.Error('error-avatar-url-handling', `Error while handling avatar setting from a URL (${dataURI}) for ${user.username}`, { function: 'RocketChat.setUserAvatar', url: dataURI, username: user.username });\n\t\t\t}\n\t\t}\n\n\t\tif (result.statusCode !== 200) {\n\t\t\tconsole.log(`Not a valid response, ${result.statusCode}, from the avatar url: ${dataURI}`);\n\t\t\tthrow new Meteor.Error('error-avatar-invalid-url', `Invalid avatar URL: ${dataURI}`, { function: 'RocketChat.setUserAvatar', url: dataURI });\n\t\t}\n\n\t\tif (!/image\\/.+/.test(result.headers['content-type'])) {\n\t\t\tconsole.log(`Not a valid content-type from the provided url, ${result.headers['content-type']}, from the avatar url: ${dataURI}`);\n\t\t\tthrow new Meteor.Error('error-avatar-invalid-url', `Invalid avatar URL: ${dataURI}`, { function: 'RocketChat.setUserAvatar', url: dataURI });\n\t\t}\n\n\t\tencoding = 'binary';\n\t\timage = result.content;\n\t\tcontentType = result.headers['content-type'];\n\t} else if (service === 'rest') {\n\t\tencoding = 'binary';\n\t\timage = dataURI;\n\t} else {\n\t\tconst fileData = RocketChatFile.dataURIParse(dataURI);\n\t\tencoding = 'base64';\n\t\timage = fileData.image;\n\t\tcontentType = fileData.contentType;\n\t}\n\n\tconst rs = RocketChatFile.bufferToStream(new Buffer(image, encoding));\n\tRocketChatFileAvatarInstance.deleteFile(encodeURIComponent(`${user.username}.jpg`));\n\tconst ws = RocketChatFileAvatarInstance.createWriteStream(encodeURIComponent(`${user.username}.jpg`), contentType);\n\tws.on('end', Meteor.bindEnvironment(function() {\n\t\tMeteor.setTimeout(function() {\n\t\t\tRocketChat.models.Users.setAvatarOrigin(user._id, service);\n\t\t\tRocketChat.Notifications.notifyLogged('updateAvatar', {username: user.username});\n\t\t}, 500);\n\t}));\n\trs.pipe(ws);\n};\n","RocketChat._setEmail = function(userId, email) {\n\temail = s.trim(email);\n\tif (!userId) {\n\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { function: '_setEmail' });\n\t}\n\n\tif (!email) {\n\t\tthrow new Meteor.Error('error-invalid-email', 'Invalid email', { function: '_setEmail' });\n\t}\n\n\tRocketChat.validateEmailDomain(email);\n\n\tconst user = RocketChat.models.Users.findOneById(userId);\n\n\t// User already has desired username, return\n\tif (user.emails && user.emails[0] && user.emails[0].address === email) {\n\t\treturn user;\n\t}\n\n\t// Check email availability\n\tif (!RocketChat.checkEmailAvailability(email)) {\n\t\tthrow new Meteor.Error('error-field-unavailable', email + ' is already in use :(', { function: '_setEmail', field: email });\n\t}\n\n\t// Set new email\n\tRocketChat.models.Users.setEmail(user._id, email);\n\tuser.email = email;\n\treturn user;\n};\n\nRocketChat.setEmail = RocketChat.RateLimiter.limitFunction(RocketChat._setEmail, 1, 60000, {\n\t0: function(userId) { return !userId || !RocketChat.authz.hasPermission(userId, 'edit-other-user-info'); } // Administrators have permission to change others emails, so don't limit those\n});\n","RocketChat.unarchiveRoom = function(rid) {\n\tRocketChat.models.Rooms.unarchiveById(rid);\n\tRocketChat.models.Subscriptions.unarchiveByRoomId(rid);\n};\n","RocketChat.updateMessage = function(message, user) {\n\t// If we keep history of edits, insert a new message to store history information\n\tif (RocketChat.settings.get('Message_KeepHistory')) {\n\t\tRocketChat.models.Messages.cloneAndSaveAsHistoryById(message._id);\n\t}\n\n\tmessage.editedAt = new Date();\n\tmessage.editedBy = {\n\t\t_id: user._id,\n\t\tusername: user.username\n\t};\n\n\tconst urls = message.msg.match(/([A-Za-z]{3,9}):\\/\\/([-;:&=\\+\\$,\\w]+@{1})?([-A-Za-z0-9\\.]+)+:?(\\d+)?((\\/[-\\+=!:~%\\/\\.@\\,\\w]*)?\\??([-\\+=&!:;%@\\/\\.\\,\\w]+)?(?:#([^\\s\\)]+))?)?/g);\n\tif (urls) {\n\t\tmessage.urls = urls.map((url) => { return { url: url }; });\n\t}\n\n\tmessage = RocketChat.callbacks.run('beforeSaveMessage', message);\n\n\tconst tempid = message._id;\n\tdelete message._id;\n\n\tRocketChat.models.Messages.update({ _id: tempid }, { $set: message });\n\n\tconst room = RocketChat.models.Rooms.findOneById(message.rid);\n\n\tMeteor.defer(function() {\n\t\tRocketChat.callbacks.run('afterSaveMessage', RocketChat.models.Messages.findOneById(tempid), room);\n\t});\n};\n","import ModelsBaseDb from './_BaseDb';\nimport ModelsBaseCache from './_BaseCache';\n\nRocketChat.models._CacheControl = new Meteor.EnvironmentVariable();\n\nclass ModelsBase {\n\tconstructor(nameOrModel, useCache) {\n\t\tthis._db = new ModelsBaseDb(nameOrModel, this);\n\t\tthis.model = this._db.model;\n\t\tthis.collectionName = this._db.collectionName;\n\t\tthis.name = this._db.name;\n\n\t\tthis._useCache = useCache === true;\n\n\t\tthis.cache = new ModelsBaseCache(this);\n\t\t// TODO_CACHE: remove\n\t\tthis.on = this.cache.on.bind(this.cache);\n\t\tthis.emit = this.cache.emit.bind(this.cache);\n\t\tthis.getDynamicView = this.cache.getDynamicView.bind(this.cache);\n\t\tthis.processQueryOptionsOnResult = this.cache.processQueryOptionsOnResult.bind(this.cache);\n\t\t// END_TODO_CACHE\n\n\t\tthis.db = this;\n\n\t\tif (this._useCache) {\n\t\t\tthis.db = new this.constructor(this.model, false);\n\t\t}\n\t}\n\n\tget useCache() {\n\t\tif (RocketChat.models._CacheControl.get() === false) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this._useCache;\n\t}\n\n\tget origin() {\n\t\treturn this.useCache === true ? 'cache' : '_db';\n\t}\n\n\tarrayToCursor(data) {\n\t\treturn {\n\t\t\tfetch() {\n\t\t\t\treturn data;\n\t\t\t},\n\t\t\tcount() {\n\t\t\t\treturn data.length;\n\t\t\t},\n\t\t\tforEach(fn) {\n\t\t\t\treturn data.forEach(fn);\n\t\t\t}\n\t\t};\n\t}\n\n\tsetUpdatedAt(/*record, checkQuery, query*/) {\n\t\treturn this._db.setUpdatedAt(...arguments);\n\t}\n\n\tfind() {\n\t\ttry {\n\t\t\treturn this[this.origin].find(...arguments);\n\t\t} catch (e) {\n\t\t\tconsole.error('Exception on find', e, ...arguments);\n\t\t}\n\t}\n\n\tfindOne() {\n\t\ttry {\n\t\t\treturn this[this.origin].findOne(...arguments);\n\t\t} catch (e) {\n\t\t\tconsole.error('Exception on find', e, ...arguments);\n\t\t}\n\t}\n\n\tfindOneById() {\n\t\ttry {\n\t\t\treturn this[this.origin].findOneById(...arguments);\n\t\t} catch (e) {\n\t\t\tconsole.error('Exception on find', e, ...arguments);\n\t\t}\n\t}\n\n\tfindOneByIds(ids, options) {\n\t\tcheck(ids, [String]);\n\n\t\ttry {\n\t\t\treturn this[this.origin].findOneByIds(ids, options);\n\t\t} catch (e) {\n\t\t\tconsole.error('Exception on find', e, ...arguments);\n\t\t}\n\t}\n\n\tinsert(/*record*/) {\n\t\treturn this._db.insert(...arguments);\n\t}\n\n\tupdate(/*query, update, options*/) {\n\t\treturn this._db.update(...arguments);\n\t}\n\n\tupsert(/*query, update*/) {\n\t\treturn this._db.upsert(...arguments);\n\t}\n\n\tremove(/*query*/) {\n\t\treturn this._db.remove(...arguments);\n\t}\n\n\tinsertOrUpsert() {\n\t\treturn this._db.insertOrUpsert(...arguments);\n\t}\n\n\tallow() {\n\t\treturn this._db.allow(...arguments);\n\t}\n\n\tdeny() {\n\t\treturn this._db.deny(...arguments);\n\t}\n\n\tensureIndex() {\n\t\treturn this._db.ensureIndex(...arguments);\n\t}\n\n\tdropIndex() {\n\t\treturn this._db.dropIndex(...arguments);\n\t}\n\n\ttryEnsureIndex() {\n\t\treturn this._db.tryEnsureIndex(...arguments);\n\t}\n\n\ttryDropIndex() {\n\t\treturn this._db.tryDropIndex(...arguments);\n\t}\n\n\ttrashFind(/*query, options*/) {\n\t\treturn this._db.trashFind(...arguments);\n\t}\n\n\ttrashFindDeletedAfter(/*deletedAt, query, options*/) {\n\t\treturn this._db.trashFindDeletedAfter(...arguments);\n\t}\n\n\t// dinamicTrashFindAfter(method, deletedAt, ...args) {\n\t// \tconst scope = {\n\t// \t\tfind: (query={}) => {\n\t// \t\t\treturn this.trashFindDeletedAfter(deletedAt, query, { fields: {_id: 1, _deletedAt: 1} });\n\t// \t\t}\n\t// \t};\n\n\t// \tscope.model = {\n\t// \t\tfind: scope.find\n\t// \t};\n\n\t// \treturn this[method].apply(scope, args);\n\t// }\n\n\t// dinamicFindAfter(method, updatedAt, ...args) {\n\t// \tconst scope = {\n\t// \t\tfind: (query={}, options) => {\n\t// \t\t\tquery._updatedAt = {\n\t// \t\t\t\t$gt: updatedAt\n\t// \t\t\t};\n\n\t// \t\t\treturn this.find(query, options);\n\t// \t\t}\n\t// \t};\n\n\t// \tscope.model = {\n\t// \t\tfind: scope.find\n\t// \t};\n\n\t// \treturn this[method].apply(scope, args);\n\t// }\n\n\t// dinamicFindChangesAfter(method, updatedAt, ...args) {\n\t// \treturn {\n\t// \t\tupdate: this.dinamicFindAfter(method, updatedAt, ...args).fetch(),\n\t// \t\tremove: this.dinamicTrashFindAfter(method, updatedAt, ...args).fetch()\n\t// \t};\n\t// }\n\n}\n\nRocketChat.models._Base = ModelsBase;\n","/* eslint new-cap: 0 */\n\nimport loki from 'lokijs';\nimport {EventEmitter} from 'events';\nimport objectPath from 'object-path';\n\nconst logger = new Logger('BaseCache');\n\nconst lokiEq = loki.LokiOps.$eq;\nconst lokiNe = loki.LokiOps.$ne;\n\nloki.LokiOps.$eq = function(a, b) {\n\tif (Array.isArray(a)) {\n\t\treturn a.indexOf(b) !== -1;\n\t}\n\treturn lokiEq(a, b);\n};\n\nloki.LokiOps.$ne = function(a, b) {\n\tif (Array.isArray(a)) {\n\t\treturn a.indexOf(b) === -1;\n\t}\n\treturn lokiNe(a, b);\n};\n\nconst lokiIn = loki.LokiOps.$in;\nloki.LokiOps.$in = function(a, b) {\n\tif (Array.isArray(a)) {\n\t\treturn a.some(subA => lokiIn(subA, b));\n\t}\n\treturn lokiIn(a, b);\n};\n\nloki.LokiOps.$nin = function(a, b) {\n\treturn !loki.LokiOps.$in(a, b);\n};\n\nloki.LokiOps.$all = function(a, b) {\n\treturn b.every(subB => a.includes(subB));\n};\n\nloki.LokiOps.$exists = function(a, b) {\n\tif (b) {\n\t\treturn loki.LokiOps.$ne(a, undefined);\n\t}\n\n\treturn loki.LokiOps.$eq(a, undefined);\n};\n\nloki.LokiOps.$elemMatch = function(a, b) {\n\treturn _.findWhere(a, b);\n};\n\nconst ignore = [\n\t'emit',\n\t'load',\n\t'on',\n\t'addToAllIndexes'\n];\n\nfunction traceMethodCalls(target) {\n\ttarget._stats = {};\n\n\tfor (const property in target) {\n\t\tif (typeof target[property] === 'function' && ignore.indexOf(property) === -1) {\n\t\t\ttarget._stats[property] = {\n\t\t\t\tcalls: 0,\n\t\t\t\ttime: 0,\n\t\t\t\tavg: 0\n\t\t\t};\n\t\t\tconst origMethod = target[property];\n\t\t\ttarget[property] = function(...args) {\n\n\t\t\t\tif (target.loaded !== true) {\n\t\t\t\t\treturn origMethod.apply(target, args);\n\t\t\t\t}\n\n\t\t\t\tconst startTime = RocketChat.statsTracker.now();\n\t\t\t\tconst result = origMethod.apply(target, args);\n\t\t\t\tconst time = Math.round(RocketChat.statsTracker.now() - startTime) / 1000;\n\t\t\t\ttarget._stats[property].time += time;\n\t\t\t\ttarget._stats[property].calls++;\n\t\t\t\ttarget._stats[property].avg = target._stats[property].time / target._stats[property].calls;\n\n\t\t\t\treturn result;\n\t\t\t};\n\t\t}\n\t}\n\n\tsetInterval(function() {\n\t\tfor (const property in target._stats) {\n\t\t\tif (target._stats.hasOwnProperty(property) && target._stats[property].time > 0) {\n\t\t\t\tconst tags = [`property:${property}`, `collection:${target.collectionName}`];\n\t\t\t\tRocketChat.statsTracker.timing('cache.methods.time', target._stats[property].avg, tags);\n\t\t\t\tRocketChat.statsTracker.increment('cache.methods.totalTime', target._stats[property].time, tags);\n\t\t\t\tRocketChat.statsTracker.increment('cache.methods.count', target._stats[property].calls, tags);\n\t\t\t\ttarget._stats[property].avg = 0;\n\t\t\t\ttarget._stats[property].time = 0;\n\t\t\t\ttarget._stats[property].calls = 0;\n\t\t\t}\n\t\t}\n\t}, 10000);\n\n\ttarget._getStatsAvg = function() {\n\t\tconst stats = [];\n\t\tfor (const property in target._stats) {\n\t\t\tif (target._stats.hasOwnProperty(property)) {\n\t\t\t\tstats.push([Math.round(target._stats[property].avg*100)/100, property]);\n\t\t\t}\n\t\t}\n\t\treturn _.sortBy(stats, function(record) {\n\t\t\treturn record[0];\n\t\t});\n\t};\n}\n\nclass Adapter {\n\tloadDatabase(/*dbname, callback*/) {}\n\tsaveDatabase(/*dbname, dbstring, callback*/) {}\n\tdeleteDatabase(/*dbname, callback*/) {}\n}\n\nconst db = new loki('rocket.chat.json', {adapter: Adapter});\n\nclass ModelsBaseCache extends EventEmitter {\n\tconstructor(model) {\n\t\tsuper();\n\n\t\ttraceMethodCalls(this);\n\n\t\tthis.indexes = {};\n\t\tthis.ignoreUpdatedFields = ['_updatedAt'];\n\n\t\tthis.query = {};\n\t\tthis.options = {};\n\n\t\tthis.ensureIndex('_id', 'unique');\n\n\t\tthis.joins = {};\n\n\t\tthis.on('inserted', (...args) => { this.emit('changed', 'inserted', ...args); });\n\t\tthis.on('removed', (...args) => { this.emit('changed', 'removed', ...args); });\n\t\tthis.on('updated', (...args) => { this.emit('changed', 'updated', ...args); });\n\n\t\tthis.on('beforeinsert', (...args) => { this.emit('beforechange', 'inserted', ...args); });\n\t\tthis.on('beforeremove', (...args) => { this.emit('beforechange', 'removed', ...args); });\n\t\tthis.on('beforeupdate', (...args) => { this.emit('beforechange', 'updated', ...args); });\n\n\t\tthis.on('inserted', (...args) => { this.emit('sync', 'inserted', ...args); });\n\t\tthis.on('updated', (...args) => { this.emit('sync', 'updated', ...args); });\n\t\tthis.on('beforeremove', (...args) => { this.emit('sync', 'removed', ...args); });\n\n\t\tthis.db = db;\n\n\t\tthis.model = model;\n\n\t\tthis.collectionName = this.model._db.collectionName;\n\t\tthis.collection = this.db.addCollection(this.collectionName);\n\t}\n\n\thasOne(join, {field, link}) {\n\t\tthis.join({join, field, link, multi: false});\n\t}\n\n\thasMany(join, {field, link}) {\n\t\tthis.join({join, field, link, multi: true});\n\t}\n\n\tjoin({join, field, link, multi}) {\n\t\tif (!RocketChat.models[join]) {\n\t\t\tconsole.log(`Invalid cache model ${join}`);\n\t\t\treturn;\n\t\t}\n\n\t\tRocketChat.models[join].cache.on('inserted', (record) => {\n\t\t\tthis.processRemoteJoinInserted({join, field, link, multi, record: record});\n\t\t});\n\n\t\tRocketChat.models[join].cache.on('beforeupdate', (record, diff) => {\n\t\t\tif (diff[link.remote]) {\n\t\t\t\tthis.processRemoteJoinRemoved({join, field, link, multi, record: record});\n\t\t\t}\n\t\t});\n\n\t\tRocketChat.models[join].cache.on('updated', (record, diff) => {\n\t\t\tif (diff[link.remote]) {\n\t\t\t\tthis.processRemoteJoinInserted({join, field, link, multi, record: record});\n\t\t\t}\n\t\t});\n\n\t\tRocketChat.models[join].cache.on('removed', (record) => {\n\t\t\tthis.processRemoteJoinRemoved({join, field, link, multi, record: record});\n\t\t});\n\n\t\tthis.on('inserted', (localRecord) => {\n\t\t\tthis.processLocalJoinInserted({join, field, link, multi, localRecord: localRecord});\n\t\t});\n\n\t\tthis.on('beforeupdate', (localRecord, diff) => {\n\t\t\tif (diff[link.local]) {\n\t\t\t\tif (multi === true) {\n\t\t\t\t\tlocalRecord[field] = [];\n\t\t\t\t} else {\n\t\t\t\t\tlocalRecord[field] = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.on('updated', (localRecord, diff) => {\n\t\t\tif (diff[link.local]) {\n\t\t\t\tthis.processLocalJoinInserted({join, field, link, multi, localRecord: localRecord});\n\t\t\t}\n\t\t});\n\t}\n\n\tprocessRemoteJoinInserted({field, link, multi, record}) {\n\t\tlet localRecords = this._findByIndex(link.local, objectPath.get(record, link.remote));\n\n\t\tif (!localRecords) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Array.isArray(localRecords)) {\n\t\t\tlocalRecords = [localRecords];\n\t\t}\n\n\t\tfor (var i = 0; i < localRecords.length; i++) {\n\t\t\tconst localRecord = localRecords[i];\n\t\t\tif (multi === true && !localRecord[field]) {\n\t\t\t\tlocalRecord[field] = [];\n\t\t\t}\n\n\t\t\tif (typeof link.transform === 'function') {\n\t\t\t\trecord = link.transform(localRecord, record);\n\t\t\t}\n\n\t\t\tif (multi === true) {\n\t\t\t\tlocalRecord[field].push(record);\n\t\t\t} else {\n\t\t\t\tlocalRecord[field] = record;\n\t\t\t}\n\n\t\t\tthis.emit(`join:${field}:inserted`, localRecord, record);\n\t\t\tthis.emit(`join:${field}:changed`, 'inserted', localRecord, record);\n\t\t}\n\t}\n\n\tprocessLocalJoinInserted({join, field, link, multi, localRecord}) {\n\t\tlet records = RocketChat.models[join].cache._findByIndex(link.remote, objectPath.get(localRecord, link.local));\n\n\t\tif (!Array.isArray(records)) {\n\t\t\trecords = [records];\n\t\t}\n\n\t\tfor (let i = 0; i < records.length; i++) {\n\t\t\tlet record = records[i];\n\n\t\t\tif (typeof link.transform === 'function') {\n\t\t\t\trecord = link.transform(localRecord, record);\n\t\t\t}\n\n\t\t\tif (multi === true) {\n\t\t\t\tlocalRecord[field].push(record);\n\t\t\t} else {\n\t\t\t\tlocalRecord[field] = record;\n\t\t\t}\n\n\t\t\tthis.emit(`join:${field}:inserted`, localRecord, record);\n\t\t\tthis.emit(`join:${field}:changed`, 'inserted', localRecord, record);\n\t\t}\n\t}\n\n\tprocessRemoteJoinRemoved({field, link, multi, record}) {\n\t\tlet localRecords = this._findByIndex(link.local, objectPath.get(record, link.remote));\n\n\t\tif (!localRecords) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Array.isArray(localRecords)) {\n\t\t\tlocalRecords = [localRecords];\n\t\t}\n\n\t\tfor (var i = 0; i < localRecords.length; i++) {\n\t\t\tconst localRecord = localRecords[i];\n\n\t\t\tif (multi === true) {\n\t\t\t\tif (Array.isArray(localRecord[field])) {\n\t\t\t\t\tif (typeof link.remove === 'function') {\n\t\t\t\t\t\tlink.remove(localRecord[field], record);\n\t\t\t\t\t} else if (localRecord[field].indexOf(record) > -1) {\n\t\t\t\t\t\tlocalRecord[field].splice(localRecord[field].indexOf(record), 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlocalRecord[field] = undefined;\n\t\t\t}\n\n\t\t\tthis.emit(`join:${field}:removed`, localRecord, record);\n\t\t\tthis.emit(`join:${field}:changed`, 'removed', localRecord, record);\n\t\t}\n\t}\n\n\tensureIndex(fields, type='array') {\n\t\tif (!Array.isArray(fields)) {\n\t\t\tfields = [fields];\n\t\t}\n\n\t\tthis.indexes[fields.join(',')] = {\n\t\t\ttype: type,\n\t\t\tfields: fields,\n\t\t\tdata: {}\n\t\t};\n\t}\n\n\taddToAllIndexes(record) {\n\t\tfor (const indexName in this.indexes) {\n\t\t\tif (this.indexes.hasOwnProperty(indexName)) {\n\t\t\t\tthis.addToIndex(indexName, record);\n\t\t\t}\n\t\t}\n\t}\n\n\taddToIndex(indexName, record) {\n\t\tconst index = this.indexes[indexName];\n\t\tif (!index) {\n\t\t\tconsole.error(`Index not defined ${indexName}`);\n\t\t\treturn;\n\t\t}\n\n\t\tconst keys = [];\n\t\tfor (const field of index.fields) {\n\t\t\tkeys.push(objectPath.get(record, field));\n\t\t}\n\t\tconst key = keys.join('|');\n\n\t\tif (index.type === 'unique') {\n\t\t\tindex.data[key] = record;\n\t\t\treturn;\n\t\t}\n\n\t\tif (index.type === 'array') {\n\t\t\tif (!index.data[key]) {\n\t\t\t\tindex.data[key] = [];\n\t\t\t}\n\t\t\tindex.data[key].push(record);\n\t\t\treturn;\n\t\t}\n\t}\n\n\tremoveFromAllIndexes(record) {\n\t\tfor (const indexName in this.indexes) {\n\t\t\tif (this.indexes.hasOwnProperty(indexName)) {\n\t\t\t\tthis.removeFromIndex(indexName, record);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveFromIndex(indexName, record) {\n\t\tconst index = this.indexes[indexName];\n\t\tif (!this.indexes[indexName]) {\n\t\t\tconsole.error(`Index not defined ${indexName}`);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!index.data) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet key = [];\n\t\tfor (const field of index.fields) {\n\t\t\tkey.push(objectPath.get(record, field));\n\t\t}\n\t\tkey = key.join('|');\n\n\t\tif (index.type === 'unique') {\n\t\t\tindex.data[key] = undefined;\n\t\t\treturn;\n\t\t}\n\n\t\tif (index.type === 'array') {\n\t\t\tif (!index.data[key]) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst i = index.data[key].indexOf(record);\n\t\t\tif (i > -1) {\n\t\t\t\tindex.data[key].splice(i, 1);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t}\n\n\t_findByIndex(index, keys) {\n\t\tconst key = [].concat(keys).join('|');\n\t\tif (!this.indexes[index]) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.indexes[index].data) {\n\t\t\tconst result = this.indexes[index].data[key];\n\t\t\tif (result) {\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\n\t\tif (this.indexes[index].type === 'array') {\n\t\t\treturn [];\n\t\t}\n\t}\n\n\tfindByIndex(index, keys, options={}) {\n\t\treturn {\n\t\t\tfetch: () => {\n\t\t\t\treturn this.processQueryOptionsOnResult(this._findByIndex(index, keys), options);\n\t\t\t},\n\n\t\t\tcount: () => {\n\t\t\t\tconst records = this.findByIndex(index, keys, options).fetch();\n\t\t\t\tif (Array.isArray(records)) {\n\t\t\t\t\treturn records.length;\n\t\t\t\t}\n\t\t\t\treturn !records ? 0 : 1;\n\t\t\t},\n\n\t\t\tforEach: (fn) => {\n\t\t\t\tconst records = this.findByIndex(index, keys, options).fetch();\n\t\t\t\tif (Array.isArray(records)) {\n\t\t\t\t\treturn records.forEach(fn);\n\t\t\t\t}\n\t\t\t\tif (records) {\n\t\t\t\t\treturn fn(records);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tload() {\n\t\tif (this.model._useCache === false) {\n\t\t\treturn;\n\t\t}\n\n\t\tconsole.log('Will load cache for', this.collectionName);\n\t\tthis.emit('beforeload');\n\t\tthis.loaded = false;\n\t\tconst time = RocketChat.statsTracker.now();\n\t\tconst data = this.model.db.find(this.query, this.options).fetch();\n\t\tfor (let i=0; i < data.length; i++) {\n\t\t\tthis.insert(data[i]);\n\t\t}\n\t\tconsole.log(String(data.length), 'records load from', this.collectionName);\n\t\tRocketChat.statsTracker.timing('cache.load', RocketChat.statsTracker.now() - time, [`collection:${this.collectionName}`]);\n\n\t\tthis.startSync();\n\t\tthis.loaded = true;\n\t\tthis.emit('afterload');\n\t}\n\n\tstartSync() {\n\t\tif (this.model._useCache === false) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.model._db.on('change', ({action, id, data/*, oplog*/}) => {\n\t\t\tswitch (action) {\n\t\t\t\tcase 'insert':\n\t\t\t\t\tdata._id = id;\n\t\t\t\t\tthis.insert(data);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'remove':\n\t\t\t\t\tthis.removeById(id);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'update:record':\n\t\t\t\t\tthis.updateDiffById(id, data);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'update:diff':\n\t\t\t\t\tthis.updateDiffById(id, data);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'update:query':\n\t\t\t\t\tthis.update(data.query, data.update, data.options);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\t}\n\n\tprocessQueryOptionsOnResult(result, options={}) {\n\t\tif (result === undefined || result === null) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (Array.isArray(result)) {\n\t\t\tif (options.sort) {\n\t\t\t\tresult = result.sort((a, b) => {\n\t\t\t\t\tlet r = 0;\n\t\t\t\t\tfor (const field in options.sort) {\n\t\t\t\t\t\tif (options.sort.hasOwnProperty(field)) {\n\t\t\t\t\t\t\tconst direction = options.sort[field];\n\t\t\t\t\t\t\tlet valueA;\n\t\t\t\t\t\t\tlet valueB;\n\t\t\t\t\t\t\tif (field.indexOf('.') > -1) {\n\t\t\t\t\t\t\t\tvalueA = objectPath.get(a, field);\n\t\t\t\t\t\t\t\tvalueB = objectPath.get(b, field);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvalueA = a[field];\n\t\t\t\t\t\t\t\tvalueB = b[field];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (valueA > valueB) {\n\t\t\t\t\t\t\t\tr = direction;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (valueA < valueB) {\n\t\t\t\t\t\t\t\tr = -direction;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn r;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (typeof options.skip === 'number') {\n\t\t\t\tresult.splice(0, options.skip);\n\t\t\t}\n\n\t\t\tif (typeof options.limit === 'number' && options.limit !== 0) {\n\t\t\t\tresult.splice(options.limit);\n\t\t\t}\n\t\t}\n\n\t\tif (!options.fields) {\n\t\t\toptions.fields = {};\n\t\t}\n\n\t\tconst fieldsToRemove = [];\n\t\tconst fieldsToGet = [];\n\n\t\tfor (const field in options.fields) {\n\t\t\tif (options.fields.hasOwnProperty(field)) {\n\t\t\t\tif (options.fields[field] === 0) {\n\t\t\t\t\tfieldsToRemove.push(field);\n\t\t\t\t} else if (options.fields[field] === 1) {\n\t\t\t\t\tfieldsToGet.push(field);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (fieldsToRemove.length > 0 && fieldsToGet.length > 0) {\n\t\t\tconsole.warn('Can\\'t mix remove and get fields');\n\t\t\tfieldsToRemove.splice(0, fieldsToRemove.length);\n\t\t}\n\n\t\tif (fieldsToGet.length > 0 && fieldsToGet.indexOf('_id') === -1) {\n\t\t\tfieldsToGet.push('_id');\n\t\t}\n\n\t\tconst pickFields = (obj, fields) => {\n\t\t\tconst picked = {};\n\t\t\tfields.forEach((field) => {\n\t\t\t\tif (field.indexOf('.') !== -1) {\n\t\t\t\t\tobjectPath.set(picked, field, objectPath.get(obj, field));\n\t\t\t\t} else {\n\t\t\t\t\tpicked[field] = obj[field];\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn picked;\n\t\t};\n\n\t\tif (fieldsToRemove.length > 0 || fieldsToGet.length > 0) {\n\t\t\tif (Array.isArray(result)) {\n\t\t\t\tresult = result.map((record) => {\n\t\t\t\t\tif (fieldsToRemove.length > 0) {\n\t\t\t\t\t\treturn _.omit(record, ...fieldsToRemove);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (fieldsToGet.length > 0) {\n\t\t\t\t\t\treturn pickFields(record, fieldsToGet);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tif (fieldsToRemove.length > 0) {\n\t\t\t\t\treturn _.omit(result, ...fieldsToRemove);\n\t\t\t\t}\n\n\t\t\t\tif (fieldsToGet.length > 0) {\n\t\t\t\t\treturn pickFields(result, fieldsToGet);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprocessQuery(query, parentField) {\n\t\tif (!query) {\n\t\t\treturn query;\n\t\t}\n\n\t\tif (Match.test(query, String)) {\n\t\t\treturn {\n\t\t\t\t_id: query\n\t\t\t};\n\t\t}\n\n\t\tif (Object.keys(query).length > 1 && parentField !== '$elemMatch') {\n\t\t\tconst and = [];\n\t\t\tfor (const field in query) {\n\t\t\t\tif (query.hasOwnProperty(field)) {\n\t\t\t\t\tand.push({\n\t\t\t\t\t\t[field]: query[field]\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tquery = {$and: and};\n\t\t}\n\n\t\tfor (const field in query) {\n\t\t\tif (query.hasOwnProperty(field)) {\n\t\t\t\tconst value = query[field];\n\t\t\t\tif (value instanceof RegExp && field !== '$regex') {\n\t\t\t\t\tquery[field] = {\n\t\t\t\t\t\t$regex: value\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (field === '$and' || field === '$or') {\n\t\t\t\t\tquery[field] = value.map((subValue) => {\n\t\t\t\t\t\treturn this.processQuery(subValue, field);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (Match.test(value, Object) && Object.keys(value).length > 0) {\n\t\t\t\t\tquery[field] = this.processQuery(value, field);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn query;\n\t}\n\n\tfind(query, options={}) {\n\t\treturn {\n\t\t\tfetch: () => {\n\t\t\t\ttry {\n\t\t\t\t\tquery = this.processQuery(query);\n\t\t\t\t\treturn this.processQueryOptionsOnResult(this.collection.find(query), options);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('Exception on cache find for', this.collectionName);\n\t\t\t\t\tconsole.error('Query:', JSON.stringify(query, null, 2));\n\t\t\t\t\tconsole.error('Options:', JSON.stringify(options, null, 2));\n\t\t\t\t\tconsole.error(e.stack);\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tcount: () => {\n\t\t\t\ttry {\n\t\t\t\t\tquery = this.processQuery(query);\n\t\t\t\t\tconst { limit, skip } = options;\n\t\t\t\t\treturn this.processQueryOptionsOnResult(this.collection.find(query), { limit, skip }).length;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('Exception on cache find for', this.collectionName);\n\t\t\t\t\tconsole.error('Query:', JSON.stringify(query, null, 2));\n\t\t\t\t\tconsole.error('Options:', JSON.stringify(options, null, 2));\n\t\t\t\t\tconsole.error(e.stack);\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tforEach: (fn) => {\n\t\t\t\treturn this.find(query, options).fetch().forEach(fn);\n\t\t\t},\n\n\t\t\tobserve: (obj) => {\n\t\t\t\tlogger.debug(this.collectionName, 'Falling back observe to model with query:', query);\n\t\t\t\treturn this.model.db.find(...arguments).observe(obj);\n\t\t\t},\n\n\t\t\tobserveChanges: (obj) => {\n\t\t\t\tlogger.debug(this.collectionName, 'Falling back observeChanges to model with query:', query);\n\t\t\t\treturn this.model.db.find(...arguments).observeChanges(obj);\n\t\t\t},\n\n\t\t\t_publishCursor: (cursor, sub, collection) => {\n\t\t\t\tlogger.debug(this.collectionName, 'Falling back _publishCursor to model with query:', query);\n\t\t\t\treturn this.model.db.find(...arguments)._publishCursor(cursor, sub, collection);\n\t\t\t}\n\t\t};\n\t}\n\n\tfindOne(query, options) {\n\t\ttry {\n\t\t\tquery = this.processQuery(query);\n\t\t\treturn this.processQueryOptionsOnResult(this.collection.findOne(query), options);\n\t\t} catch (e) {\n\t\t\tconsole.error('Exception on cache findOne for', this.collectionName);\n\t\t\tconsole.error('Query:', JSON.stringify(query, null, 2));\n\t\t\tconsole.error('Options:', JSON.stringify(options, null, 2));\n\t\t\tconsole.error(e.stack);\n\t\t\tthrow e;\n\t\t}\n\t}\n\n\tfindOneById(_id, options) {\n\t\treturn this.findByIndex('_id', _id, options).fetch();\n\t}\n\n\tfindOneByIds(ids, options) {\n\t\tconst query = this.processQuery({ _id: { $in: ids }});\n\t\treturn this.processQueryOptionsOnResult(this.collection.findOne(query), options);\n\t}\n\n\tfindWhere(query, options) {\n\t\tquery = this.processQuery(query);\n\t\treturn this.processQueryOptionsOnResult(this.collection.findWhere(query), options);\n\t}\n\n\taddDynamicView() {\n\t\treturn this.collection.addDynamicView(...arguments);\n\t}\n\n\tgetDynamicView() {\n\t\treturn this.collection.getDynamicView(...arguments);\n\t}\n\n\tinsert(record) {\n\t\tif (Array.isArray(record)) {\n\t\t\tfor (const item of record) {\n\t\t\t\tthis.insert(item);\n\t\t\t}\n\t\t} else {\n\t\t\t// TODO remove - ignore updates in room.usernames\n\t\t\tif (this.collectionName === 'rocketchat_room' && record.usernames) {\n\t\t\t\tdelete record.usernames;\n\t\t\t}\n\t\t\tthis.emit('beforeinsert', record);\n\t\t\tthis.addToAllIndexes(record);\n\t\t\tthis.collection.insert(record);\n\t\t\tthis.emit('inserted', record);\n\t\t}\n\t}\n\n\tupdateDiffById(id, diff) {\n\t\t// TODO remove - ignore updates in room.usernames\n\t\tif (this.collectionName === 'rocketchat_room' && diff.usernames) {\n\t\t\tdelete diff.usernames;\n\t\t}\n\n\t\tconst record = this._findByIndex('_id', id);\n\t\tif (!record) {\n\t\t\tconsole.error('Cache.updateDiffById: No record', this.collectionName, id, diff);\n\t\t\treturn;\n\t\t}\n\n\t\tconst updatedFields = _.without(Object.keys(diff), ...this.ignoreUpdatedFields);\n\n\t\tif (updatedFields.length > 0) {\n\t\t\tthis.emit('beforeupdate', record, diff);\n\t\t}\n\n\t\tfor (const key in diff) {\n\t\t\tif (diff.hasOwnProperty(key)) {\n\t\t\t\tobjectPath.set(record, key, diff[key]);\n\t\t\t}\n\t\t}\n\n\t\tthis.collection.update(record);\n\n\t\tif (updatedFields.length > 0) {\n\t\t\tthis.emit('updated', record, diff);\n\t\t}\n\t}\n\n\tupdateRecord(record, update) {\n\t\t// TODO remove - ignore updates in room.usernames\n\t\tif (this.collectionName === 'rocketchat_room' && (record.usernames || (record.$set && record.$set.usernames))) {\n\t\t\tdelete record.usernames;\n\t\t\tif (record.$set && record.$set.usernames) {\n\t\t\t\tdelete record.$set.usernames;\n\t\t\t}\n\t\t}\n\n\t\tconst topLevelFields = Object.keys(update).map(field => field.split('.')[0]);\n\t\tconst updatedFields = _.without(topLevelFields, ...this.ignoreUpdatedFields);\n\n\t\tif (updatedFields.length > 0) {\n\t\t\tthis.emit('beforeupdate', record, record);\n\t\t}\n\n\t\tif (update.$set) {\n\t\t\t_.each(update.$set, (value, field) => {\n\t\t\t\tobjectPath.set(record, field, value);\n\t\t\t});\n\t\t}\n\n\t\tif (update.$unset) {\n\t\t\t_.each(update.$unset, (value, field) => {\n\t\t\t\tobjectPath.del(record, field);\n\t\t\t});\n\t\t}\n\n\t\tif (update.$min) {\n\t\t\t_.each(update.$min, (value, field) => {\n\t\t\t\tconst curValue = objectPath.get(record, field);\n\t\t\t\tif (curValue === undefined || value < curValue) {\n\t\t\t\t\tobjectPath.set(record, field, value);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (update.$max) {\n\t\t\t_.each(update.$max, (value, field) => {\n\t\t\t\tconst curValue = objectPath.get(record, field);\n\t\t\t\tif (curValue === undefined || value > curValue) {\n\t\t\t\t\tobjectPath.set(record, field, value);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (update.$inc) {\n\t\t\t_.each(update.$inc, (value, field) => {\n\t\t\t\tlet curValue = objectPath.get(record, field);\n\t\t\t\tif (curValue === undefined) {\n\t\t\t\t\tcurValue = value;\n\t\t\t\t} else {\n\t\t\t\t\tcurValue += value;\n\t\t\t\t}\n\t\t\t\tobjectPath.set(record, field, curValue);\n\t\t\t});\n\t\t}\n\n\t\tif (update.$mul) {\n\t\t\t_.each(update.$mul, (value, field) => {\n\t\t\t\tlet curValue = objectPath.get(record, field);\n\t\t\t\tif (curValue === undefined) {\n\t\t\t\t\tcurValue = 0;\n\t\t\t\t} else {\n\t\t\t\t\tcurValue *= value;\n\t\t\t\t}\n\t\t\t\tobjectPath.set(record, field, curValue);\n\t\t\t});\n\t\t}\n\n\t\tif (update.$rename) {\n\t\t\t_.each(update.$rename, (value, field) => {\n\t\t\t\tconst curValue = objectPath.get(record, field);\n\t\t\t\tif (curValue !== undefined) {\n\t\t\t\t\tobjectPath.set(record, value, curValue);\n\t\t\t\t\tobjectPath.del(record, field);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (update.$pullAll) {\n\t\t\t_.each(update.$pullAll, (value, field) => {\n\t\t\t\tlet curValue = objectPath.get(record, field);\n\t\t\t\tif (Array.isArray(curValue)) {\n\t\t\t\t\tcurValue = _.difference(curValue, value);\n\t\t\t\t\tobjectPath.set(record, field, curValue);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (update.$pop) {\n\t\t\t_.each(update.$pop, (value, field) => {\n\t\t\t\tconst curValue = objectPath.get(record, field);\n\t\t\t\tif (Array.isArray(curValue)) {\n\t\t\t\t\tif (value === -1) {\n\t\t\t\t\t\tcurValue.shift();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcurValue.pop();\n\t\t\t\t\t}\n\t\t\t\t\tobjectPath.set(record, field, curValue);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tif (update.$addToSet) {\n\t\t\t_.each(update.$addToSet, (value, field) => {\n\t\t\t\tlet curValue = objectPath.get(record, field);\n\t\t\t\tif (curValue === undefined) {\n\t\t\t\t\tcurValue = [];\n\t\t\t\t}\n\t\t\t\tif (Array.isArray(curValue)) {\n\t\t\t\t\tconst length = curValue.length;\n\n\t\t\t\t\tif (value && value.$each && Array.isArray(value.$each)) {\n\t\t\t\t\t\tfor (const valueItem of value.$each) {\n\t\t\t\t\t\t\tif (curValue.indexOf(valueItem) === -1) {\n\t\t\t\t\t\t\t\tcurValue.push(valueItem);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (curValue.indexOf(value) === -1) {\n\t\t\t\t\t\tcurValue.push(value);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (curValue.length > length) {\n\t\t\t\t\t\tobjectPath.set(record, field, curValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.collection.update(record);\n\n\t\tif (updatedFields.length > 0) {\n\t\t\tthis.emit('updated', record, record);\n\t\t}\n\t}\n\n\tupdate(query, update, options = {}) {\n\t\tlet records = options.multi ? this.find(query).fetch() : this.findOne(query) || [];\n\t\tif (!Array.isArray(records)) {\n\t\t\trecords = [records];\n\t\t}\n\n\t\tfor (const record of records) {\n\t\t\tthis.updateRecord(record, update);\n\t\t}\n\t}\n\n\tremoveById(id) {\n\t\tconst record = this._findByIndex('_id', id);\n\t\tif (record) {\n\t\t\tthis.emit('beforeremove', record);\n\t\t\tthis.collection.removeWhere({_id: id});\n\t\t\tthis.removeFromAllIndexes(record);\n\t\t\tthis.emit('removed', record);\n\t\t}\n\t}\n}\n\nexport default ModelsBaseCache;\n","/* globals MongoInternals */\n\nconst baseName = 'rocketchat_';\nimport {EventEmitter} from 'events';\n\nconst trash = new Mongo.Collection(baseName + '_trash');\ntry {\n\ttrash._ensureIndex({ collection: 1 });\n\ttrash._ensureIndex({ _deletedAt: 1 }, { expireAfterSeconds: 60 * 60 * 24 * 30 });\n} catch (e) {\n\tconsole.log(e);\n}\n\nconst isOplogAvailable = MongoInternals.defaultRemoteCollectionDriver().mongo._oplogHandle && !!MongoInternals.defaultRemoteCollectionDriver().mongo._oplogHandle.onOplogEntry;\nlet isOplogEnabled = isOplogAvailable;\nRocketChat.settings.get('Force_Disable_OpLog_For_Cache', (key, value) => {\n\tisOplogEnabled = isOplogAvailable && value === false;\n});\n\nclass ModelsBaseDb extends EventEmitter {\n\tconstructor(model, baseModel) {\n\t\tsuper();\n\n\t\tif (Match.test(model, String)) {\n\t\t\tthis.name = model;\n\t\t\tthis.collectionName = this.baseName + this.name;\n\t\t\tthis.model = new Mongo.Collection(this.collectionName);\n\t\t} else {\n\t\t\tthis.name = model._name;\n\t\t\tthis.collectionName = this.name;\n\t\t\tthis.model = model;\n\t\t}\n\n\t\tthis.baseModel = baseModel;\n\n\t\tthis.wrapModel();\n\n\t\t// When someone start listening for changes we start oplog if available\n\t\tthis.once('newListener', (event/*, listener*/) => {\n\t\t\tif (event === 'change') {\n\t\t\t\tif (isOplogEnabled) {\n\t\t\t\t\tconst query = {\n\t\t\t\t\t\tcollection: this.collectionName\n\t\t\t\t\t};\n\n\t\t\t\t\tMongoInternals.defaultRemoteCollectionDriver().mongo._oplogHandle.onOplogEntry(query, this.processOplogRecord.bind(this));\n\t\t\t\t\tMongoInternals.defaultRemoteCollectionDriver().mongo._oplogHandle._defineTooFarBehind(Number.MAX_SAFE_INTEGER);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.tryEnsureIndex({ '_updatedAt': 1 });\n\t}\n\n\tget baseName() {\n\t\treturn baseName;\n\t}\n\n\tsetUpdatedAt(record = {}) {\n\n\t\t// TODO: Check if this can be deleted, Rodrigo does not rememebr WHY he added it. So he removed it to fix issue #5541\n\t\t// setUpdatedAt(record = {}, checkQuery = false, query) {\n\t\t// if (checkQuery === true) {\n\t\t// \tif (!query || Object.keys(query).length === 0) {\n\t\t// \t\tthrow new Meteor.Error('Models._Base: Empty query');\n\t\t// \t}\n\t\t// }\n\n\t\tif (/(^|,)\\$/.test(Object.keys(record).join(','))) {\n\t\t\trecord.$set = record.$set || {};\n\t\t\trecord.$set._updatedAt = new Date;\n\t\t} else {\n\t\t\trecord._updatedAt = new Date;\n\t\t}\n\n\t\treturn record;\n\t}\n\n\twrapModel() {\n\t\tthis.originals = {\n\t\t\tinsert: this.model.insert.bind(this.model),\n\t\t\tupdate: this.model.update.bind(this.model),\n\t\t\tremove: this.model.remove.bind(this.model)\n\t\t};\n\t\tconst self = this;\n\n\t\tthis.model.insert = function() {\n\t\t\treturn self.insert(...arguments);\n\t\t};\n\n\t\tthis.model.update = function() {\n\t\t\treturn self.update(...arguments);\n\t\t};\n\n\t\tthis.model.remove = function() {\n\t\t\treturn self.remove(...arguments);\n\t\t};\n\t}\n\n\tfind() {\n\t\treturn this.model.find(...arguments);\n\t}\n\n\tfindOne() {\n\t\treturn this.model.findOne(...arguments);\n\t}\n\n\tfindOneById(_id, options) {\n\t\treturn this.model.findOne({ _id }, options);\n\t}\n\n\tfindOneByIds(ids, options) {\n\t\treturn this.model.findOne({ _id: { $in: ids }}, options);\n\t}\n\n\tdefineSyncStrategy(query, modifier, options) {\n\t\tif (this.baseModel.useCache === false) {\n\t\t\treturn 'db';\n\t\t}\n\n\t\tif (options.upsert === true) {\n\t\t\treturn 'db';\n\t\t}\n\n\t\t// const dbModifiers = [\n\t\t// \t'$currentDate',\n\t\t// \t'$bit',\n\t\t// \t'$pull',\n\t\t// \t'$pushAll',\n\t\t// \t'$push',\n\t\t// \t'$setOnInsert'\n\t\t// ];\n\n\t\tconst cacheAllowedModifiers = [\n\t\t\t'$set',\n\t\t\t'$unset',\n\t\t\t'$min',\n\t\t\t'$max',\n\t\t\t'$inc',\n\t\t\t'$mul',\n\t\t\t'$rename',\n\t\t\t'$pullAll',\n\t\t\t'$pop',\n\t\t\t'$addToSet'\n\t\t];\n\n\t\tconst notAllowedModifiers = Object.keys(modifier).filter(i => i.startsWith('$') && cacheAllowedModifiers.includes(i) === false);\n\n\t\tif (notAllowedModifiers.length > 0) {\n\t\t\treturn 'db';\n\t\t}\n\n\t\tconst placeholderFields = Object.keys(query).filter(item => item.indexOf('$') > -1);\n\t\tif (placeholderFields.length > 0) {\n\t\t\treturn 'db';\n\t\t}\n\n\t\treturn 'cache';\n\t}\n\n\tupdateHasPositionalOperator(update) {\n\t\tfor (const key in update) {\n\t\t\tif (key.includes('.$')) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tconst value = update[key];\n\n\t\t\tif (Match.test(value, Object)) {\n\t\t\t\tif (this.updateHasPositionalOperator(value) === true) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tprocessOplogRecord(action) {\n\t\tif (isOplogEnabled === false) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (action.op.op === 'i') {\n\t\t\tthis.emit('change', {\n\t\t\t\taction: 'insert',\n\t\t\t\tid: action.op.o._id,\n\t\t\t\tdata: action.op.o,\n\t\t\t\toplog: true\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tif (action.op.op === 'u') {\n\t\t\tif (!action.op.o.$set && !action.op.o.$unset) {\n\t\t\t\tthis.emit('change', {\n\t\t\t\t\taction: 'update:record',\n\t\t\t\t\tid: action.id,\n\t\t\t\t\tdata: action.op.o,\n\t\t\t\t\toplog: true\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst diff = {};\n\t\t\tif (action.op.o.$set) {\n\t\t\t\tfor (const key in action.op.o.$set) {\n\t\t\t\t\tif (action.op.o.$set.hasOwnProperty(key)) {\n\t\t\t\t\t\tdiff[key] = action.op.o.$set[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (action.op.o.$unset) {\n\t\t\t\tfor (const key in action.op.o.$unset) {\n\t\t\t\t\tif (action.op.o.$unset.hasOwnProperty(key)) {\n\t\t\t\t\t\tdiff[key] = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.emit('change', {\n\t\t\t\taction: 'update:diff',\n\t\t\t\tid: action.id,\n\t\t\t\tdata: diff,\n\t\t\t\toplog: true\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tif (action.op.op === 'd') {\n\t\t\tthis.emit('change', {\n\t\t\t\taction: 'remove',\n\t\t\t\tid: action.id,\n\t\t\t\toplog: true\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t}\n\n\tinsert(record) {\n\t\tthis.setUpdatedAt(record);\n\n\t\tconst result = this.originals.insert(...arguments);\n\t\tif (!isOplogEnabled && this.listenerCount('change') > 0) {\n\t\t\tthis.emit('change', {\n\t\t\t\taction: 'insert',\n\t\t\t\tid: result,\n\t\t\t\tdata: _.extend({}, record),\n\t\t\t\toplog: false\n\t\t\t});\n\t\t}\n\n\t\trecord._id = result;\n\n\t\treturn result;\n\t}\n\n\tupdate(query, update, options = {}) {\n\t\tthis.setUpdatedAt(update, true, query);\n\n\t\tconst strategy = this.defineSyncStrategy(query, update, options);\n\t\tlet ids = [];\n\t\tif (!isOplogEnabled && this.listenerCount('change') > 0 && strategy === 'db') {\n\t\t\tconst findOptions = {fields: {_id: 1}};\n\t\t\tlet records = options.multi ? this.find(query, findOptions).fetch() : this.findOne(query, findOptions) || [];\n\t\t\tif (!Array.isArray(records)) {\n\t\t\t\trecords = [records];\n\t\t\t}\n\n\t\t\tids = records.map(item => item._id);\n\t\t\tif (options.upsert !== true && this.updateHasPositionalOperator(update) === false) {\n\t\t\t\tquery = {\n\t\t\t\t\t_id: {\n\t\t\t\t\t\t$in: ids\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tconst result = this.originals.update(query, update, options);\n\n\t\tif (!isOplogEnabled && this.listenerCount('change') > 0) {\n\t\t\tif (strategy === 'db') {\n\t\t\t\tif (options.upsert === true) {\n\t\t\t\t\tif (result.insertedId) {\n\t\t\t\t\t\tthis.emit('change', {\n\t\t\t\t\t\t\taction: 'insert',\n\t\t\t\t\t\t\tid: result.insertedId,\n\t\t\t\t\t\t\tdata: this.findOne({_id: result.insertedId}),\n\t\t\t\t\t\t\toplog: false\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tquery = {\n\t\t\t\t\t\t_id: {\n\t\t\t\t\t\t\t$in: ids\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tlet records = options.multi ? this.find(query).fetch() : this.findOne(query) || [];\n\t\t\t\tif (!Array.isArray(records)) {\n\t\t\t\t\trecords = [records];\n\t\t\t\t}\n\t\t\t\tfor (const record of records) {\n\t\t\t\t\tthis.emit('change', {\n\t\t\t\t\t\taction: 'update:record',\n\t\t\t\t\t\tid: record._id,\n\t\t\t\t\t\tdata: record,\n\t\t\t\t\t\toplog: false\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.emit('change', {\n\t\t\t\t\taction: 'update:query',\n\t\t\t\t\tid: undefined,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tquery: query,\n\t\t\t\t\t\tupdate: update,\n\t\t\t\t\t\toptions: options\n\t\t\t\t\t},\n\t\t\t\t\toplog: false\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tupsert(query, update, options = {}) {\n\t\toptions.upsert = true;\n\t\toptions._returnObject = true;\n\t\treturn this.update(query, update, options);\n\t}\n\n\tremove(query) {\n\t\tconst records = this.model.find(query).fetch();\n\n\t\tconst ids = [];\n\t\tfor (const record of records) {\n\t\t\tids.push(record._id);\n\n\t\t\trecord._deletedAt = new Date;\n\t\t\trecord.__collection__ = this.name;\n\n\t\t\ttrash.upsert({_id: record._id}, _.omit(record, '_id'));\n\t\t}\n\n\t\tquery = { _id: { $in: ids } };\n\n\t\tconst result = this.originals.remove(query);\n\n\t\tif (!isOplogEnabled && this.listenerCount('change') > 0) {\n\t\t\tfor (const record of records) {\n\t\t\t\tthis.emit('change', {\n\t\t\t\t\taction: 'remove',\n\t\t\t\t\tid: record._id,\n\t\t\t\t\tdata: _.extend({}, record),\n\t\t\t\t\toplog: false\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tinsertOrUpsert(...args) {\n\t\tif (args[0] && args[0]._id) {\n\t\t\tconst _id = args[0]._id;\n\t\t\tdelete args[0]._id;\n\t\t\targs.unshift({\n\t\t\t\t_id: _id\n\t\t\t});\n\n\t\t\tthis.upsert(...args);\n\t\t\treturn _id;\n\t\t} else {\n\t\t\treturn this.insert(...args);\n\t\t}\n\t}\n\n\tallow() {\n\t\treturn this.model.allow(...arguments);\n\t}\n\n\tdeny() {\n\t\treturn this.model.deny(...arguments);\n\t}\n\n\tensureIndex() {\n\t\treturn this.model._ensureIndex(...arguments);\n\t}\n\n\tdropIndex() {\n\t\treturn this.model._dropIndex(...arguments);\n\t}\n\n\ttryEnsureIndex() {\n\t\ttry {\n\t\t\treturn this.ensureIndex(...arguments);\n\t\t} catch (e) {\n\t\t\tconsole.error('Error creating index:', this.name, '->', ...arguments, e);\n\t\t}\n\t}\n\n\ttryDropIndex() {\n\t\ttry {\n\t\t\treturn this.dropIndex(...arguments);\n\t\t} catch (e) {\n\t\t\tconsole.error('Error dropping index:', this.name, '->', ...arguments, e);\n\t\t}\n\t}\n\n\ttrashFind(query, options) {\n\t\tquery.__collection__ = this.name;\n\n\t\treturn trash.find(query, options);\n\t}\n\n\ttrashFindDeletedAfter(deletedAt, query = {}, options) {\n\t\tquery.__collection__ = this.name;\n\t\tquery._deletedAt = {\n\t\t\t$gt: deletedAt\n\t\t};\n\n\t\treturn trash.find(query, options);\n\t}\n}\n\nexport default ModelsBaseDb;\n","RocketChat.statsTracker = new (class StatsTracker {\n\tconstructor() {\n\t\tthis.StatsD = Npm.require('node-dogstatsd').StatsD;\n\t\tthis.dogstatsd = new this.StatsD();\n\t}\n\n\ttrack(type, stats, ...args) {\n\t\tthis.dogstatsd[type](`RocketChat.${stats}`, ...args);\n\t}\n\n\tnow() {\n\t\tconst hrtime = process.hrtime();\n\t\treturn (hrtime[0] * 1000000 + hrtime[1] / 1000);\n\t}\n\n\ttiming(stats, time, tags) {\n\t\tthis.track('timing', stats, time, tags);\n\t}\n\n\tincrement(stats, time, tags) {\n\t\tthis.track('increment', stats, time, tags);\n\t}\n\n\tdecrement(stats, time, tags) {\n\t\tthis.track('decrement', stats, time, tags);\n\t}\n\n\thistogram(stats, time, tags) {\n\t\tthis.track('histogram', stats, time, tags);\n\t}\n\n\tgauge(stats, time, tags) {\n\t\tthis.track('gauge', stats, time, tags);\n\t}\n\n\tunique(stats, time, tags) {\n\t\tthis.track('unique', stats, time, tags);\n\t}\n\n\tset(stats, time, tags) {\n\t\tthis.track('set', stats, time, tags);\n\t}\n});\n","RocketChat.models.Rooms.cache.hasMany('Subscriptions', {\n\tfield: 'usernames',\n\tlink: {\n\t\tlocal: '_id',\n\t\tremote: 'rid',\n\t\ttransform(room, subscription) {\n\t\t\treturn subscription.u.username;\n\t\t},\n\t\tremove(arr, subscription) {\n\t\t\tif (arr.indexOf(subscription.u.username) > -1) {\n\t\t\t\tarr.splice(arr.indexOf(subscription.u.username), 1);\n\t\t\t}\n\t\t}\n\t}\n});\n\n\nRocketChat.models.Subscriptions.cache.hasOne('Rooms', {\n\tfield: '_room',\n\tlink: {\n\t\tlocal: 'rid',\n\t\tremote: '_id'\n\t}\n});\n\n\nRocketChat.models.Subscriptions.cache.hasOne('Users', {\n\tfield: '_user',\n\tlink: {\n\t\tlocal: 'u._id',\n\t\tremote: '_id'\n\t}\n});\n\n\nRocketChat.models.Users.cache.load();\nRocketChat.models.Rooms.cache.load();\nRocketChat.models.Subscriptions.cache.load();\nRocketChat.models.Settings.cache.load();\n\n\nRocketChat.models.Users.cache.addDynamicView('highlights').applyFind({\n\t'settings.preferences.highlights': {$size: {$gt: 0}}\n});\n\nRocketChat.models.Subscriptions.cache.addDynamicView('notifications').applyFind({\n\t$or: [\n\t\t{desktopNotifications: {$in: ['all', 'nothing']}},\n\t\t{mobilePushNotifications: {$in: ['all', 'nothing']}}\n\t]\n});\n","/* eslint no-multi-spaces: 0 */\n/* eslint comma-spacing: 0 */\n\nMeteor.methods({\n\taddOAuthService(name) {\n\n\t\tcheck(name, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'addOAuthService' });\n\t\t}\n\n\t\tif (RocketChat.authz.hasPermission(Meteor.userId(), 'add-oauth-service') !== true) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Adding OAuth Services is not allowed', { method: 'addOAuthService', action: 'Adding_OAuth_Services' });\n\t\t}\n\n\t\tname = name.toLowerCase().replace(/[^a-z0-9_]/g, '');\n\t\tname = s.capitalize(name);\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${name}`                   , false             , { type: 'boolean', group: 'OAuth', section: `Custom OAuth: ${name}`, i18nLabel: 'Accounts_OAuth_Custom_Enable', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${name}-url`               , ''                , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${name}`, i18nLabel: 'URL', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${name}-token_path`        , '/oauth/token'    , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${name}`, i18nLabel: 'Accounts_OAuth_Custom_Token_Path', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${name}-identity_path`     , '/me'             , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${name}`, i18nLabel: 'Accounts_OAuth_Custom_Identity_Path', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${name}-authorize_path`    , '/oauth/authorize', { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${name}`, i18nLabel: 'Accounts_OAuth_Custom_Authorize_Path', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${name}-scope`             , 'openid'          , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${name}`, i18nLabel: 'Accounts_OAuth_Custom_Scope', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${name}-token_sent_via`    , 'payload'         , { type: 'select' , group: 'OAuth', section: `Custom OAuth: ${name}`, i18nLabel: 'Accounts_OAuth_Custom_Token_Sent_Via', persistent: true, values: [ { key: 'header', i18nLabel: 'Header' }, { key: 'payload', i18nLabel: 'Payload' } ] });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${name}-id`                , ''                , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${name}`, i18nLabel: 'Accounts_OAuth_Custom_id', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${name}-secret`            , ''                , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${name}`, i18nLabel: 'Accounts_OAuth_Custom_Secret', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${name}-login_style`       , 'popup'           , { type: 'select' , group: 'OAuth', section: `Custom OAuth: ${name}`, i18nLabel: 'Accounts_OAuth_Custom_Login_Style', persistent: true, values: [ { key: 'redirect', i18nLabel: 'Redirect' }, { key: 'popup', i18nLabel: 'Popup' }, { key: '', i18nLabel: 'Default' } ] });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${name}-button_label_text` , ''                , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${name}`, i18nLabel: 'Accounts_OAuth_Custom_Button_Label_Text', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${name}-button_label_color`, '#FFFFFF'         , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${name}`, i18nLabel: 'Accounts_OAuth_Custom_Button_Label_Color', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${name}-button_color`      , '#13679A'         , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${name}`, i18nLabel: 'Accounts_OAuth_Custom_Button_Color', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${name}-username_field`    , ''                , { type: 'string' , group: 'OAuth', section: `Custom OAuth: ${name}`, i18nLabel: 'Accounts_OAuth_Custom_Username_Field', persistent: true });\n\t\tRocketChat.settings.add(`Accounts_OAuth_Custom-${name}-merge_users`       , false             , { type: 'boolean', group: 'OAuth', section: `Custom OAuth: ${name}`, i18nLabel: 'Accounts_OAuth_Custom_Merge_Users', persistent: true });\n\t}});\n","Meteor.methods({\n\trefreshOAuthService() {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'refreshOAuthService' });\n\t\t}\n\n\t\tif (RocketChat.authz.hasPermission(Meteor.userId(), 'add-oauth-service') !== true) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Refresh OAuth Services is not allowed', { method: 'refreshOAuthService', action: 'Refreshing_OAuth_Services' });\n\t\t}\n\n\t\tServiceConfiguration.configurations.remove({});\n\n\t\tRocketChat.models.Settings.update({_id: /^Accounts_OAuth_.+/}, {$set: {_updatedAt: new Date}}, {multi: true});\n\t}\n});\n","Meteor.methods({\n\taddUserToRoom: function(data) {\n\t\treturn Meteor.call('addUsersToRoom', {\n\t\t\trid: data.rid,\n\t\t\tusers: [ data.username ]\n\t\t});\n\t}\n});\n","Meteor.methods({\n\taddUsersToRoom(data = {}) {\n\t\t// Validate user and room\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', {\n\t\t\t\tmethod: 'addUsersToRoom'\n\t\t\t});\n\t\t}\n\n\t\tif (!Match.test(data.rid, String)) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', {\n\t\t\t\tmethod: 'addUsersToRoom'\n\t\t\t});\n\t\t}\n\n\t\t// Get user and room details\n\t\tconst room = RocketChat.models.Rooms.findOneById(data.rid);\n\t\tconst userId = Meteor.userId();\n\t\tconst user = Meteor.user();\n\t\tconst userInRoom = Array.isArray(room.usernames) && room.usernames.includes(user.username);\n\n\t\t// Can't add to direct room ever\n\t\tif (room.t === 'd') {\n\t\t\tthrow new Meteor.Error('error-cant-invite-for-direct-room', 'Can\\'t invite user to direct rooms', {\n\t\t\t\tmethod: 'addUsersToRoom'\n\t\t\t});\n\t\t}\n\n\t\t// Can add to any room you're in, with permission, otherwise need specific room type permission\n\t\tlet canAddUser = false;\n\t\tif (userInRoom && RocketChat.authz.hasPermission(userId, 'add-user-to-joined-room', room._id)) {\n\t\t\tcanAddUser = true;\n\t\t} else if (room.t === 'c' && RocketChat.authz.hasPermission(userId, 'add-user-to-any-c-room')) {\n\t\t\tcanAddUser = true;\n\t\t} else if (room.t === 'p' && RocketChat.authz.hasPermission(userId, 'add-user-to-any-p-room')) {\n\t\t\tcanAddUser = true;\n\t\t}\n\n\t\t// Adding wasn't allowed\n\t\tif (!canAddUser) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', {\n\t\t\t\tmethod: 'addUsersToRoom'\n\t\t\t});\n\t\t}\n\n\t\t// Missing the users to be added\n\t\tif (!Array.isArray(data.users)) {\n\t\t\tthrow new Meteor.Error('error-invalid-arguments', 'Invalid arguments', {\n\t\t\t\tmethod: 'addUsersToRoom'\n\t\t\t});\n\t\t}\n\n\t\t// Validate each user, then add to room\n\t\tdata.users.forEach((username) => {\n\t\t\tconst newUser = RocketChat.models.Users.findOneByUsername(username);\n\t\t\tif (!newUser) {\n\t\t\t\tthrow new Meteor.Error('error-invalid-username', 'Invalid username', {\n\t\t\t\t\tmethod: 'addUsersToRoom'\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tRocketChat.addUserToRoom(data.rid, newUser, user);\n\t\t});\n\n\t\treturn true;\n\t}\n});\n","Meteor.methods({\n\tarchiveRoom(rid) {\n\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'archiveRoom' });\n\t\t}\n\n\t\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\n\t\tif (!room) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', { method: 'archiveRoom' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'archive-room', room._id)) {\n\t\t\tthrow new Meteor.Error('error-not-authorized', 'Not authorized', { method: 'archiveRoom' });\n\t\t}\n\n\t\treturn RocketChat.archiveRoom(rid);\n\t}\n});\n","Meteor.methods({\n\tblockUser({rid, blocked}) {\n\n\t\tcheck(rid, String);\n\t\tcheck(blocked, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'blockUser' });\n\t\t}\n\n\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, Meteor.userId());\n\t\tconst subscription2 = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, blocked);\n\n\t\tif (!subscription || !subscription2) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', { method: 'blockUser' });\n\t\t}\n\n\t\tRocketChat.models.Subscriptions.setBlockedByRoomId(rid, blocked, Meteor.userId());\n\n\t\treturn true;\n\t}\n});\n","Meteor.methods({\n\tcheckRegistrationSecretURL(hash) {\n\n\t\tcheck(hash, String);\n\n\t\treturn hash === RocketChat.settings.get('Accounts_RegistrationForm_SecretURL');\n\t}\n});\n","Meteor.methods({\n\tcleanChannelHistory({roomId, latest, oldest, inclusive}) {\n\t\tcheck(roomId, String);\n\t\tcheck(latest, Date);\n\t\tcheck(oldest, Date);\n\t\tcheck(inclusive, Boolean);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'cleanChannelHistory' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'clean-channel-history')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'cleanChannelHistory' });\n\t\t}\n\n\t\tif (inclusive) {\n\t\t\tRocketChat.models.Messages.remove({\n\t\t\t\trid: roomId,\n\t\t\t\tts: {\n\t\t\t\t\t$gte: oldest,\n\t\t\t\t\t$lte: latest\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tRocketChat.models.Messages.remove({\n\t\t\t\trid: roomId,\n\t\t\t\tts: {\n\t\t\t\t\t$gt: oldest,\n\t\t\t\t\t$lt: latest\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n});\n","Meteor.methods({\n\tcreateChannel(name, members, readOnly = false, customFields = {}) {\n\t\tcheck(name, String);\n\t\tcheck(members, Match.Optional([String]));\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'createChannel' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'create-c')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'createChannel' });\n\t\t}\n\n\t\treturn RocketChat.createRoom('c', name, Meteor.user() && Meteor.user().username, members, readOnly, {customFields});\n\t}\n});\n","Meteor.methods({\n\tcreatePrivateGroup(name, members, readOnly = false, customFields = {}) {\n\t\tcheck(name, String);\n\t\tcheck(members, Match.Optional([String]));\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'createPrivateGroup' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'create-p')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'createPrivateGroup' });\n\t\t}\n\n\t\treturn RocketChat.createRoom('p', name, Meteor.user() && Meteor.user().username, members, readOnly, {customFields});\n\t}\n});\n","Meteor.methods({\n\tdeleteUserOwnAccount: function(password) {\n\n\t\tcheck(password, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'deleteUserOwnAccount' });\n\t\t}\n\n\t\tif (!RocketChat.settings.get('Accounts_AllowDeleteOwnAccount')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'deleteUserOwnAccount' });\n\t\t}\n\n\t\tconst userId = Meteor.userId();\n\t\tconst user = RocketChat.models.Users.findOneById(userId);\n\n\t\tif (!user) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'deleteUserOwnAccount' });\n\t\t}\n\n\t\tif (user.services && user.services.password && s.trim(user.services.password.bcrypt)) {\n\t\t\tconst result = Accounts._checkPassword(user, { digest: password, algorithm: 'sha-256' });\n\t\t\tif (result.error) {\n\t\t\t\tthrow new Meteor.Error('error-invalid-password', 'Invalid password', { method: 'deleteUserOwnAccount' });\n\t\t\t}\n\t\t} else if (user.username !== s.trim(password)) {\n\t\t\tthrow new Meteor.Error('error-invalid-username', 'Invalid username', { method: 'deleteUserOwnAccount' });\n\t\t}\n\n\t\tMeteor.defer(function() {\n\t\t\tRocketChat.deleteUser(userId);\n\t\t});\n\n\t\treturn true;\n\t}\n});\n","var Filter = Npm.require('bad-words');\n\nRocketChat.callbacks.add('beforeSaveMessage', function(message) {\n\n\tif (RocketChat.settings.get('Message_AllowBadWordsFilter')) {\n\t\tvar badWordsList = RocketChat.settings.get('Message_BadWordsFilterList');\n\t\tvar options;\n\n\t\t// Add words to the blacklist\n\t\tif (!!badWordsList && badWordsList.length) {\n\t\t\toptions = {\n\t\t\t\tlist: badWordsList.split(',')\n\t\t\t};\n\t\t}\n\t\tvar filter = new Filter(options);\n\t\tmessage.msg = filter.clean(message.msg);\n\t}\n\n\treturn message;\n\n}, 1, 'filterBadWords');\n","RocketChat.callbacks.add('beforeSaveMessage', function(message) {\n\t// Test if the message mentions include @all.\n\tif (message.mentions != null &&\n\t\t_.pluck(message.mentions, '_id').some((item) => item === 'all')) {\n\n\t\t// Check if the user has permissions to use @all.\n\t\tif (!RocketChat.authz.hasPermission(message.u._id, 'mention-all')) {\n\n\t\t\t// Get the language of the user for the error notification.\n\t\t\tconst language = RocketChat.models.Users.findOneById(message.u._id).language;\n\t\t\tconst action = TAPi18n.__('Notify_all_in_this_room', {}, language);\n\n\t\t\t// Add a notification to the chat, informing the user that this\n\t\t\t// action is not allowed.\n\t\t\tRocketChat.Notifications.notifyUser(message.u._id, 'message', {\n\t\t\t\t_id: Random.id(),\n\t\t\t\trid: message.rid,\n\t\t\t\tts: new Date,\n\t\t\t\tmsg: TAPi18n.__('error-action-not-allowed', { action }, language)\n\t\t\t});\n\n\t\t\t// Also throw to stop propagation of 'sendMessage'.\n\t\t\tthrow new Meteor.Error(\n\t\t\t\t'error-action-not-allowed',\n\t\t\t\t'Notify all in this room not allowed',\n\t\t\t\t{\n\t\t\t\t\tmethod: 'filterATAllTag',\n\t\t\t\t\taction: 'Notify_all_in_this_room'\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\treturn message;\n\n}, 1, 'filterATAllTag');\n","Meteor.methods({\n\tgetChannelHistory({rid, latest, oldest, inclusive, count = 20, unreads}) {\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'getChannelHistory' });\n\t\t}\n\n\t\tconst fromUserId = Meteor.userId();\n\t\tconst room = Meteor.call('canAccessRoom', rid, fromUserId);\n\t\tif (!room) {\n\t\t\treturn false;\n\t\t}\n\n\t\t//Make sure they can access the room\n\t\tif (room.t === 'c' && !RocketChat.authz.hasPermission(fromUserId, 'preview-c-room') && room.usernames.indexOf(room.username) === -1) {\n\t\t\treturn false;\n\t\t}\n\n\t\t//Ensure latest is always defined.\n\t\tif (_.isUndefined(latest)) {\n\t\t\tlatest = new Date();\n\t\t}\n\n\t\t//Verify oldest is a date if it exists\n\t\tif (!_.isUndefined(oldest) && !_.isDate(oldest)) {\n\t\t\tthrow new Meteor.Error('error-invalid-date', 'Invalid date', { method: 'getChannelHistory' });\n\t\t}\n\n\t\tconst options = {\n\t\t\tsort: {\n\t\t\t\tts: -1\n\t\t\t},\n\t\t\tlimit: count\n\t\t};\n\n\t\tif (!RocketChat.settings.get('Message_ShowEditedStatus')) {\n\t\t\toptions.fields = { 'editedAt': 0 };\n\t\t}\n\n\t\tlet records = [];\n\t\tif (_.isUndefined(oldest) && inclusive) {\n\t\t\trecords = RocketChat.models.Messages.findVisibleByRoomIdBeforeTimestampInclusive(rid, latest, options).fetch();\n\t\t} else if (_.isUndefined(oldest) && !inclusive) {\n\t\t\trecords = RocketChat.models.Messages.findVisibleByRoomIdBeforeTimestamp(rid, latest, options).fetch();\n\t\t} else if (!_.isUndefined(oldest) && inclusive) {\n\t\t\trecords = RocketChat.models.Messages.findVisibleByRoomIdBetweenTimestampsInclusive(rid, oldest, latest, options).fetch();\n\t\t} else {\n\t\t\trecords = RocketChat.models.Messages.findVisibleByRoomIdBetweenTimestamps(rid, oldest, latest, options).fetch();\n\t\t}\n\n\t\tconst messages = _.map(records, (message) => {\n\t\t\tmessage.starred = _.findWhere(message.starred, { _id: fromUserId });\n\t\t\treturn message;\n\t\t});\n\n\t\tif (unreads) {\n\t\t\tlet unreadNotLoaded = 0;\n\t\t\tlet firstUnread = undefined;\n\n\t\t\tif (!_.isUndefined(oldest)) {\n\t\t\t\tconst firstMsg = messages[messages.length - 1];\n\t\t\t\tif (!_.isUndefined(firstMsg) && firstMsg.ts > oldest) {\n\t\t\t\t\tconst unreadMessages = RocketChat.models.Messages.findVisibleByRoomIdBetweenTimestamps(rid, oldest, firstMsg.ts, { limit: 1, sort: { ts: 1 } });\n\t\t\t\t\tfirstUnread = unreadMessages.fetch()[0];\n\t\t\t\t\tunreadNotLoaded = unreadMessages.count();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tmessages,\n\t\t\t\tfirstUnread,\n\t\t\t\tunreadNotLoaded\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tmessages\n\t\t};\n\t}\n});\n","Meteor.methods({\n\tgetFullUserData({ filter = '', limit }) {\n\t\tconst result = RocketChat.getFullUserData({ userId: Meteor.userId(), filter, limit });\n\n\t\tif (!result) {\n\t\t\treturn result;\n\t\t}\n\n\t\treturn result.fetch();\n\t}\n});\n","Meteor.methods({\n\tgetRoomRoles(rid) {\n\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'getRoomRoles' });\n\t\t}\n\n\t\tcheck(rid, String);\n\n\t\tconst options = {\n\t\t\tsort: {\n\t\t\t\t'u.username': 1\n\t\t\t},\n\t\t\tfields: {\n\t\t\t\trid: 1,\n\t\t\t\tu: 1,\n\t\t\t\troles: 1\n\t\t\t}\n\t\t};\n\n\t\tconst roles = RocketChat.models.Roles.find({ scope: 'Subscriptions', description: { $exists: 1, $ne: '' } }).fetch();\n\t\treturn RocketChat.models.Subscriptions.findByRoomIdAndRoles(rid, _.pluck(roles, '_id'), options).fetch();\n\t}\n});\n","Meteor.methods({\n\tgetServerInfo() {\n\t\treturn RocketChat.Info;\n\t}\n});\n","Meteor.methods({\n\tgetUserRoles() {\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'getUserRoles' });\n\t\t}\n\n\t\tconst options = {\n\t\t\tsort: {\n\t\t\t\t'username': 1\n\t\t\t},\n\t\t\tfields: {\n\t\t\t\tusername: 1,\n\t\t\t\troles: 1\n\t\t\t}\n\t\t};\n\n\t\tconst roles = RocketChat.models.Roles.find({ scope: 'Users', description: { $exists: 1, $ne: '' } }).fetch();\n\t\tconst roleIds = _.pluck(roles, '_id');\n\n\t\t// Security issue: we should not send all user's roles to all clients, only the 'public' roles\n\t\t// We must remove all roles that are not part of the query from the returned users\n\t\tconst users = RocketChat.models.Users.findUsersInRoles(roleIds, null, options).fetch();\n\t\tfor (const user of users) {\n\t\t\tuser.roles = _.intersection(user.roles, roleIds);\n\t\t}\n\t\treturn users;\n\t}\n});\n","Meteor.methods({\n\tinsertOrUpdateUser(userData) {\n\n\t\tcheck(userData, Object);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'insertOrUpdateUser' });\n\t\t}\n\n\t\treturn RocketChat.saveUser(Meteor.userId(), userData);\n\t}\n});\n","Meteor.methods({\n\tjoinDefaultChannels(silenced) {\n\t\tcheck(silenced, Match.Optional(Boolean));\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'joinDefaultChannels' });\n\t\t}\n\n\t\tthis.unblock();\n\t\treturn RocketChat.addUserToDefaultChannels(Meteor.user(), silenced);\n\t}\n});\n","Meteor.methods({\n\tjoinRoom(rid, code) {\n\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'joinRoom' });\n\t\t}\n\n\t\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\n\t\tif (!room) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', { method: 'joinRoom' });\n\t\t}\n\n\t\tif ((room.t !== 'c') || (RocketChat.authz.hasPermission(Meteor.userId(), 'view-c-room') !== true)) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'joinRoom' });\n\t\t}\n\n\t\tif ((room.joinCodeRequired === true) && (code !== room.joinCode)) {\n\t\t\tthrow new Meteor.Error('error-code-invalid', 'Invalid Code', { method: 'joinRoom' });\n\t\t}\n\n\t\treturn RocketChat.addUserToRoom(rid, Meteor.user());\n\t}\n});\n","Meteor.methods({\n\tleaveRoom(rid) {\n\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'leaveRoom' });\n\t\t}\n\n\t\tthis.unblock();\n\n\t\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\t\tconst user = Meteor.user();\n\n\t\tif (room.t === 'd') {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'leaveRoom' });\n\t\t}\n\n\t\tif (!Array.from(room.usernames || []).includes(user.username)) {\n\t\t\tthrow new Meteor.Error('error-user-not-in-room', 'You are not in this room', { method: 'leaveRoom' });\n\t\t}\n\n\t\t// If user is room owner, check if there are other owners. If there isn't anyone else, warn user to set a new owner.\n\t\tif (RocketChat.authz.hasRole(user._id, 'owner', room._id)) {\n\t\t\tconst numOwners = RocketChat.authz.getUsersInRole('owner', room._id).fetch().length;\n\t\t\tif (numOwners === 1) {\n\t\t\t\tthrow new Meteor.Error('error-you-are-last-owner', 'You are the last owner. Please set new owner before leaving the room.', { method: 'leaveRoom' });\n\t\t\t}\n\t\t}\n\n\t\treturn RocketChat.removeUserFromRoom(rid, Meteor.user());\n\t}\n});\n","Meteor.methods({\n\tremoveOAuthService(name) {\n\n\t\tcheck(name, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'removeOAuthService' });\n\t\t}\n\n\t\tif (RocketChat.authz.hasPermission(Meteor.userId(), 'add-oauth-service') !== true) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'removeOAuthService' });\n\t\t}\n\n\t\tname = name.toLowerCase().replace(/[^a-z0-9_]/g, '');\n\t\tname = s.capitalize(name);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${name}`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${name}-url`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${name}-token_path`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${name}-identity_path`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${name}-authorize_path`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${name}-scope`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${name}-token_sent_via`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${name}-id`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${name}-secret`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${name}-button_label_text`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${name}-button_label_color`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${name}-button_color`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${name}-login_style`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${name}-username_field`);\n\t\tRocketChat.settings.removeById(`Accounts_OAuth_Custom-${name}-merge_users`);\n\t}\n});\n","Meteor.methods({\n\trestart_server() {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'restart_server' });\n\t\t}\n\n\t\tif (RocketChat.authz.hasRole(Meteor.userId(), 'admin') !== true) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'restart_server' });\n\t\t}\n\n\t\tMeteor.setTimeout(() => process.exit(1)\n\t\t, 2000);\n\n\t\treturn {\n\t\t\tmessage: 'The_server_will_restart_in_s_seconds',\n\t\t\tparams: [2]\n\t\t};\n\t}\n});\n","Meteor.methods({\n\tsaveSetting: function(_id, value, editor) {\n\t\tif (Meteor.userId() === null) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Editing settings is not allowed', {\n\t\t\t\tmethod: 'saveSetting'\n\t\t\t});\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'edit-privileged-setting')) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Editing settings is not allowed', {\n\t\t\t\tmethod: 'saveSetting'\n\t\t\t});\n\t\t}\n\n\t\t//Verify the _id passed in is a string.\n\t\tcheck(_id, String);\n\n\t\tconst setting = RocketChat.models.Settings.db.findOneById(_id);\n\n\t\t//Verify the value is what it should be\n\t\tswitch (setting.type) {\n\t\t\tcase 'roomPick':\n\t\t\t\tcheck(value, [Object]);\n\t\t\t\tbreak;\n\t\t\tcase 'boolean':\n\t\t\t\tcheck(value, Boolean);\n\t\t\t\tbreak;\n\t\t\tcase 'int':\n\t\t\t\tcheck(value, Number);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tcheck(value, String);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tRocketChat.settings.updateById(_id, value, editor);\n\t\treturn true;\n\t}\n});\n","Meteor.methods({\n\tsetAdminStatus(userId, admin) {\n\n\t\tcheck(userId, String);\n\t\tcheck(admin, Match.Optional(Boolean));\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'setAdminStatus' });\n\t\t}\n\n\t\tif (RocketChat.authz.hasPermission(Meteor.userId(), 'assign-admin-role') !== true) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'setAdminStatus' });\n\t\t}\n\n\t\tconst user = Meteor.users.findOne({ _id: userId }, { fields: { username: 1 } });\n\n\t\tif (admin) {\n\t\t\treturn Meteor.call('authorization:addUserToRole', 'admin', user.username);\n\t\t} else {\n\t\t\treturn Meteor.call('authorization:removeUserFromRole', 'admin', user.username);\n\t\t}\n\t}\n});\n","Meteor.methods({\n\tsetRealName(name) {\n\n\t\tcheck(name, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'setRealName' });\n\t\t}\n\n\t\tconst user = Meteor.user();\n\n\t\tif (user.name === name) {\n\t\t\treturn name;\n\t\t}\n\n\t\tif (_.trim(name)) {\n\t\t\tname = _.trim(name);\n\t\t}\n\n\t\tif (!RocketChat.models.Users.setName(Meteor.userId(), name)) {\n\t\t\tthrow new Meteor.Error('error-could-not-change-name', 'Could not change name', { method: 'setRealName' });\n\t\t}\n\n\t\treturn name;\n\t}\n});\n","Meteor.methods({\n\tsetUsername(username, param = {}) {\n\t\tconst { joinDefaultChannelsSilenced } = param;\n\t\tcheck(username, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'setUsername' });\n\t\t}\n\n\t\tconst user = Meteor.user();\n\n\t\tif (user.username && !RocketChat.settings.get('Accounts_AllowUsernameChange')) {\n\t\t\tthrow new Meteor.Error('error-not-allowed', 'Not allowed', { method: 'setUsername' });\n\t\t}\n\n\t\tif (user.username === username) {\n\t\t\treturn username;\n\t\t}\n\n\t\tlet nameValidation;\n\t\ttry {\n\t\t\tnameValidation = new RegExp(`^${RocketChat.settings.get('UTF8_Names_Validation')}$`);\n\t\t} catch (error) {\n\t\t\tnameValidation = new RegExp('^[0-9a-zA-Z-_.]+$');\n\t\t}\n\n\t\tif (!nameValidation.test(username)) {\n\t\t\tthrow new Meteor.Error('username-invalid', `${_.escape(username)} is not a valid username, use only letters, numbers, dots, hyphens and underscores`);\n\t\t}\n\n\t\tif (user.username !== undefined) {\n\t\t\tif (!username.toLowerCase() === user.username.toLowerCase()) {\n\t\t\t\tif (!RocketChat.checkUsernameAvailability(username)) {\n\t\t\t\t\tthrow new Meteor.Error('error-field-unavailable', `<strong>${_.escape(username)}</strong> is already in use :(`, { method: 'setUsername', field: username });\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (!RocketChat.checkUsernameAvailability(username)) {\n\t\t\tthrow new Meteor.Error('error-field-unavailable', `<strong>${_.escape(username)}</strong> is already in use :(`, { method: 'setUsername', field: username });\n\t\t}\n\n\t\tif (!RocketChat.setUsername(user._id, username)) {\n\t\t\tthrow new Meteor.Error('error-could-not-change-username', 'Could not change username', { method: 'setUsername' });\n\t\t}\n\n\t\tif (!user.username) {\n\t\t\tMeteor.runAsUser(user._id, () => Meteor.call('joinDefaultChannels', joinDefaultChannelsSilenced));\n\t\t\tMeteor.defer(function() {\n\t\t\t\treturn RocketChat.callbacks.run('afterCreateUser', RocketChat.models.Users.findOneById(user._id));\n\t\t\t});\n\t\t}\n\n\t\treturn username;\n\t}\n});\n\nRocketChat.RateLimiter.limitMethod('setUsername', 1, 1000, {\n\tuserId() { return true; }\n});\n","Meteor.methods({\n\tsetEmail: function(email) {\n\n\t\tcheck (email, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'setEmail' });\n\t\t}\n\n\t\tconst user = Meteor.user();\n\n\t\tif (!RocketChat.settings.get('Accounts_AllowEmailChange')) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Changing email is not allowed', { method: 'setEmail', action: 'Changing_email' });\n\t\t}\n\n\t\tif (user.emails && user.emails[0] && user.emails[0].address === email) {\n\t\t\treturn email;\n\t\t}\n\n\t\tif (!RocketChat.setEmail(user._id, email)) {\n\t\t\tthrow new Meteor.Error('error-could-not-change-email', 'Could not change email', { method: 'setEmail' });\n\t\t}\n\n\t\treturn email;\n\t}\n});\n\nRocketChat.RateLimiter.limitMethod('setEmail', 1, 1000, {\n\tuserId: function(/*userId*/) { return true; }\n});\n","Meteor.methods({\n\tunarchiveRoom(rid) {\n\n\t\tcheck(rid, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'unarchiveRoom' });\n\t\t}\n\n\t\tconst room = RocketChat.models.Rooms.findOneById(rid);\n\n\t\tif (!room) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', { method: 'unarchiveRoom' });\n\t\t}\n\n\t\tif (!RocketChat.authz.hasPermission(Meteor.userId(), 'unarchive-room', room._id)) {\n\t\t\tthrow new Meteor.Error('error-not-authorized', 'Not authorized', { method: 'unarchiveRoom' });\n\t\t}\n\n\t\treturn RocketChat.unarchiveRoom(rid);\n\t}\n});\n","Meteor.methods({\n\tunblockUser({rid, blocked}) {\n\n\t\tcheck(rid, String);\n\t\tcheck(blocked, String);\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'blockUser' });\n\t\t}\n\n\t\tconst subscription = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, Meteor.userId());\n\t\tconst subscription2 = RocketChat.models.Subscriptions.findOneByRoomIdAndUserId(rid, blocked);\n\n\t\tif (!subscription || !subscription2) {\n\t\t\tthrow new Meteor.Error('error-invalid-room', 'Invalid room', { method: 'blockUser' });\n\t\t}\n\n\t\tRocketChat.models.Subscriptions.unsetBlockedByRoomId(rid, blocked, Meteor.userId());\n\n\t\treturn true;\n\t}\n});\n","import moment from 'moment';\n\nMeteor.methods({\n\tupdateMessage(message) {\n\n\t\tcheck(message, Match.ObjectIncluding({_id:String}));\n\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'updateMessage' });\n\t\t}\n\n\t\tconst originalMessage = RocketChat.models.Messages.findOneById(message._id);\n\n\t\tif (!originalMessage || !originalMessage._id) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst hasPermission = RocketChat.authz.hasPermission(Meteor.userId(), 'edit-message', message.rid);\n\t\tconst editAllowed = RocketChat.settings.get('Message_AllowEditing');\n\t\tconst editOwn = originalMessage.u && originalMessage.u._id === Meteor.userId();\n\n\t\tif (!hasPermission && (!editAllowed || !editOwn)) {\n\t\t\tthrow new Meteor.Error('error-action-not-allowed', 'Message editing not allowed', { method: 'updateMessage', action: 'Message_editing' });\n\t\t}\n\n\t\tconst blockEditInMinutes = RocketChat.settings.get('Message_AllowEditing_BlockEditInMinutes');\n\t\tif (Match.test(blockEditInMinutes, Number) && blockEditInMinutes !== 0) {\n\t\t\tlet currentTsDiff, msgTs;\n\t\t\tif (Match.test(originalMessage.ts, Number)) { msgTs = moment(originalMessage.ts); }\n\t\t\tif (msgTs) { currentTsDiff = moment().diff(msgTs, 'minutes'); }\n\t\t\tif (currentTsDiff > blockEditInMinutes) {\n\t\t\t\tthrow new Meteor.Error('error-message-editing-blocked', 'Message editing is blocked', { method: 'updateMessage' });\n\t\t\t}\n\t\t}\n\n\t\tmessage.u = originalMessage.u;\n\n\t\treturn RocketChat.updateMessage(message, Meteor.user());\n\t}\n});\n","/* globals openRoom */\n\nRocketChat.roomTypes.add(null, 0, {\n\ttemplate: 'starredRooms',\n\ticon: 'icon-star'\n});\n\nRocketChat.roomTypes.add('c', 10, {\n\ttemplate: 'channels',\n\ticon: 'icon-hash',\n\troute: {\n\t\tname: 'channel',\n\t\tpath: '/channel/:name',\n\t\taction(params) {\n\t\t\treturn openRoom('c', params.name);\n\t\t}\n\t},\n\n\tfindRoom(identifier) {\n\t\tconst query = {\n\t\t\tt: 'c',\n\t\t\tname: identifier\n\t\t};\n\t\treturn ChatRoom.findOne(query);\n\t},\n\n\troomName(roomData) {\n\t\treturn roomData.name;\n\t},\n\n\tcondition() {\n\t\treturn RocketChat.authz.hasAtLeastOnePermission(['view-c-room', 'view-joined-room']);\n\t},\n\n\tshowJoinLink(roomId) {\n\t\treturn !!ChatRoom.findOne({ _id: roomId, t: 'c' });\n\t}\n});\n\nRocketChat.roomTypes.add('d', 20, {\n\ttemplate: 'directMessages',\n\ticon: 'icon-at',\n\troute: {\n\t\tname: 'direct',\n\t\tpath: '/direct/:username',\n\t\taction(params) {\n\t\t\treturn openRoom('d', params.username);\n\t\t},\n\t\tlink(sub) {\n\t\t\treturn { username: sub.name };\n\t\t}\n\t},\n\n\tfindRoom(identifier) {\n\t\tconst query = {\n\t\t\tt: 'd',\n\t\t\tname: identifier\n\t\t};\n\n\t\tconst subscription = ChatSubscription.findOne(query);\n\t\tif (subscription && subscription.rid) {\n\t\t\treturn ChatRoom.findOne(subscription.rid);\n\t\t}\n\t},\n\n\troomName(roomData) {\n\t\tconst room = ChatSubscription.findOne({ rid: roomData._id }, { fields: { name: 1 } });\n\t\treturn room && room.name;\n\t},\n\n\tcondition() {\n\t\treturn RocketChat.authz.hasAtLeastOnePermission(['view-d-room', 'view-joined-room']);\n\t},\n\n\tgetUserStatus(roomId) {\n\t\tconst subscription = RocketChat.models.Subscriptions.findOne({rid: roomId});\n\t\tif (subscription == null) { return; }\n\n\t\treturn Session.get(`user_${subscription.name}_status`);\n\t}\n});\n\nRocketChat.roomTypes.add('p', 30, {\n\ttemplate: 'privateGroups',\n\ticon: 'icon-lock',\n\troute: {\n\t\tname: 'group',\n\t\tpath: '/group/:name',\n\t\taction(params) {\n\t\t\treturn openRoom('p', params.name);\n\t\t}\n\t},\n\n\tfindRoom(identifier) {\n\t\tconst query = {\n\t\t\tt: 'p',\n\t\t\tname: identifier\n\t\t};\n\t\treturn ChatRoom.findOne(query);\n\t},\n\n\troomName(roomData) {\n\t\treturn roomData.name;\n\t},\n\n\tcondition() {\n\t\treturn RocketChat.authz.hasAllPermission('view-p-room');\n\t}\n});\n"]}