{"version":3,"sources":["meteor://ðŸ’»app/packages/rocketchat:importer/server/methods/prepareImport.js"],"names":["Meteor","methods","prepareImport","name","dataURI","contentType","fileName","userId","Error","method","check","String","Importer","Importers","importerInstance","results","prepare","Promise","catch","e"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,sBAEAA,OAAOC,OAAP,CAAe;AACdC,cADc,YACAC,IADA,EACMC,OADN,EACeC,WADf,EAC4BC,QAD5B,EACsC;AACnD,MAAI,CAACN,OAAOO,MAAP,EAAL,EAAsB;AACrB,SAAM,IAAIP,OAAOQ,KAAX,CAAiB,oBAAjB,EAAuC,cAAvC,EAAuD;AAAEC,YAAQ;AAAV,IAAvD,CAAN;AACA;;AAEDC,QAAMP,IAAN,EAAYQ,MAAZ;AACAD,QAAMN,OAAN,EAAeO,MAAf;AACAD,QAAMJ,QAAN,EAAgBK,MAAhB;;AAEA,MAAIR,QAAQS,SAASC,SAAT,CAAmBV,IAAnB,CAAR,IAAoCS,SAASC,SAAT,CAAmBV,IAAnB,EAAyBW,gBAAjE,EAAmF;AAClF,OAAMC,UAAUH,SAASC,SAAT,CAAmBV,IAAnB,EAAyBW,gBAAzB,CAA0CE,OAA1C,CAAkDZ,OAAlD,EAA2DC,WAA3D,EAAwEC,QAAxE,CAAhB;;AAEA,OAAI,QAAOS,OAAP,uDAAOA,OAAP,OAAmB,QAAvB,EAAiC;AAChC,QAAIA,mBAAmBE,OAAvB,EAAgC;AAC/B,YAAOF,QAAQG,KAAR,CAAc,aAAK;AAAE,YAAM,IAAIlB,OAAOQ,KAAX,CAAiBW,CAAjB,CAAN;AAA4B,MAAjD,CAAP;AACA,KAFD,MAEO;AACN,YAAOJ,OAAP;AACA;AACD;AACD,GAVD,MAUO,IAAI,CAACZ,IAAL,EAAW;AACjB,SAAM,IAAIH,OAAOQ,KAAX,CAAiB,4BAAjB,4BAAsEL,IAAtE,SAA+E;AAAEM,YAAQ;AAAV,IAA/E,CAAN;AACA,GAFM,MAEA;AACN,SAAM,IAAIT,OAAOQ,KAAX,CAAiB,4BAAjB,uBAAiEL,IAAjE,qEAAsI;AAAEM,YAAQ;AAAV,IAAtI,CAAN;AACA;AACD;AAzBa,CAAf,sH","file":"/packages/rocketchat_importer.js","sourcesContent":["/* globals Importer */\n\nMeteor.methods({\n\tprepareImport(name, dataURI, contentType, fileName) {\n\t\tif (!Meteor.userId()) {\n\t\t\tthrow new Meteor.Error('error-invalid-user', 'Invalid user', { method: 'prepareImport' });\n\t\t}\n\n\t\tcheck(name, String);\n\t\tcheck(dataURI, String);\n\t\tcheck(fileName, String);\n\n\t\tif (name && Importer.Importers[name] && Importer.Importers[name].importerInstance) {\n\t\t\tconst results = Importer.Importers[name].importerInstance.prepare(dataURI, contentType, fileName);\n\n\t\t\tif (typeof results === 'object') {\n\t\t\t\tif (results instanceof Promise) {\n\t\t\t\t\treturn results.catch(e => { throw new Meteor.Error(e); });\n\t\t\t\t} else {\n\t\t\t\t\treturn results;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (!name) {\n\t\t\tthrow new Meteor.Error('error-importer-not-defined', `No Importer Found: \"${name}\"`, { method: 'prepareImport' });\n\t\t} else {\n\t\t\tthrow new Meteor.Error('error-importer-not-defined', `The importer, \"${name}\", was not defined correctly, it is missing the Import class.`, { method: 'prepareImport' });\n\t\t}\n\t}\n});\n"]}